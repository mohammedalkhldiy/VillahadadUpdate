import{R as J,r as u,j as e}from"./vendor-react-Ce27NbrU.js";import{l as V,h as R,K as G,t as q}from"./index-BFvmHygk.js";import{G as re}from"./GlowCard-71-V6_az.js";import{aU as xe,a9 as ge,m as W,c0 as ie,c1 as ue,b7 as he,_ as pe,O as me,X as be,aC as fe,w as X,c7 as ee,K as te,P as ae,e as de,v as ye,b1 as ve,c8 as je,av as se,o as ke,aB as we,D as Ne,F as le,c9 as Se}from"./vendor-ui-TjLGESBy.js";import{n as De,U as ce,M as $e,R as oe,q as ne,V as Ce}from"./generateCategoricalChart-NQEqos2u.js";import{X as Ue,Y as ze,A as Le,a as Ae}from"./AreaChart-Dq4vkcq7.js";import{f as Ie,a as Ee}from"./vendor-utils-DKqDJWuS.js";import"./vendor-supabase-CSCOup90.js";import"./utils-BykweIWy.js";import"./clsx-B-dksMZM.js";var Qe=De({chartName:"BarChart",GraphicalChild:ce,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Ue},{axisType:"yAxis",AxisComp:ze}],formatAxisMap:$e});const Te=({title:k,value:h,icon:m,variant:$,trend:f,trendDirection:C="up",color:c="cyan",data:S=[],percentage:v=65,subtitle:I,disableTilt:s})=>{const o={cyan:{text:"text-cyan-400",bg:"bg-cyan-500/10",border:"border-cyan-500/20",stroke:"#22d3ee",shadow:"shadow-cyan-500/20",bar:"#06b6d4"},emerald:{text:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20",stroke:"#34d399",shadow:"shadow-emerald-500/20",bar:"#10b981"},rose:{text:"text-rose-400",bg:"bg-rose-500/10",border:"border-rose-500/20",stroke:"#fb7185",shadow:"shadow-rose-500/20",bar:"#f43f5e"},violet:{text:"text-violet-400",bg:"bg-violet-500/10",border:"border-violet-500/20",stroke:"#a78bfa",shadow:"shadow-violet-500/20",bar:"#8b5cf6"},amber:{text:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/20",stroke:"#fbbf24",shadow:"shadow-amber-500/20",bar:"#f59e0b"}}[c],p=typeof h=="number"||typeof h=="string"&&!isNaN(parseFloat(h.replace(/[^0-9.-]+/g,""))),j=p?typeof h=="string"?parseFloat(h.replace(/[^0-9.-]+/g,"")):h:0,z=xe(0,{mass:.8,stiffness:75,damping:15}),_=ge(z,E=>{const l=typeof h=="string"&&h.includes("$"),F=E.toLocaleString(void 0,{maximumFractionDigits:0});return l?`$${F}`:F});u.useEffect(()=>{p&&z.set(j||0)},[j,z,p]);const U=2*Math.PI*28,N=U-v/100*U,w={backgroundColor:"#1f2937",border:"none",borderRadius:"8px",fontSize:"10px",color:"#fff",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.5)"};return e.jsx(re,{variant:"light",glowColor:o.stroke,disableTilt:s,className:"rounded-4xl bg-white dark:bg-[#1a1c22] shadow-sm h-full transition-colors duration-300 border border-transparent dark:border-white/5",children:e.jsxs(W.div,{initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},viewport:{once:!0},className:"h-full relative overflow-hidden p-6",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 ${o.bg} blur-3xl rounded-full -mr-10 -mt-10 opacity-40 group-hover:opacity-60 transition-opacity dark:opacity-20 dark:group-hover:opacity-40`}),e.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10 w-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-gray-400 dark:text-gray-500 text-[11px] font-bold uppercase tracking-widest mb-1",children:k}),e.jsx(W.div,{className:"text-2xl font-black text-gray-900 dark:text-white tracking-tight flex items-center gap-2",children:p?_:h}),I&&e.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1 font-medium",children:I}),f&&e.jsxs("div",{className:`mt-2 inline-flex items-center gap-1 text-[10px] font-bold px-2 py-1 rounded-lg bg-gray-50 dark:bg-white/5 w-fit ${C==="up"?"text-emerald-500":"text-rose-500"}`,children:[C==="up"?e.jsx(ie,{size:10}):e.jsx(ue,{size:10}),f]})]}),e.jsx("button",{className:"text-gray-400 dark:text-gray-600 hover:text-gray-900 dark:hover:text-white transition-colors",children:e.jsx(he,{size:16})})]}),$==="circle"&&e.jsx("div",{className:"absolute bottom-4 left-4",children:e.jsxs("div",{className:"relative w-16 h-16 flex items-center justify-center",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"32",cy:"32",r:"28",stroke:"currentColor",strokeWidth:"6",fill:"transparent",className:"text-gray-100 dark:text-gray-800"}),e.jsx(W.circle,{cx:"32",cy:"32",r:"28",stroke:"currentColor",strokeWidth:"6",fill:"transparent",strokeLinecap:"round",className:o.text,initial:{strokeDasharray:U,strokeDashoffset:U},animate:{strokeDashoffset:N},transition:{duration:1.5,ease:"easeOut"}})]}),e.jsxs("span",{className:`absolute text-[10px] font-bold ${o.text}`,children:[v,"%"]})]})}),$==="wave"&&e.jsx("div",{className:"h-16 w-full -mb-2 mt-4 opacity-80 group-hover:opacity-100 transition-opacity",children:e.jsx(oe,{width:"100%",height:"100%",children:e.jsxs(Le,{data:S,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`gradient-${c}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:o.stroke,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:o.stroke,stopOpacity:0})]})}),e.jsx(ne,{contentStyle:w,itemStyle:{color:o.stroke},cursor:{stroke:o.stroke,strokeWidth:1,strokeDasharray:"3 3"}}),e.jsx(Ae,{type:"monotone",dataKey:"value",stroke:o.stroke,strokeWidth:3,fillOpacity:1,fill:`url(#gradient-${c})`,isAnimationActive:!0,animationDuration:2e3})]})})}),$==="bar"&&e.jsx("div",{className:"h-16 w-full -mb-2 mt-4 opacity-80 group-hover:opacity-100 transition-opacity flex items-end",children:e.jsx(oe,{width:"100%",height:"100%",children:e.jsxs(Qe,{data:S,children:[e.jsx(ne,{contentStyle:w,cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(ce,{dataKey:"value",radius:[4,4,0,0],isAnimationActive:!0,animationDuration:1500,children:S.map((E,l)=>e.jsx(Ce,{fill:o.bar,fillOpacity:l===S.length-1?1:.3},`cell-${l}`))})]})})}),$==="simple"&&m&&e.jsx("div",{className:`absolute bottom-4 left-4 w-12 h-12 rounded-2xl ${o.bg} flex items-center justify-center `,children:e.jsx(m,{size:20,className:o.text})})]})})},H=J.memo(Te),Re=({bookings:k,onUpdateBooking:h,disableTilt:m=!1})=>{const[$,f]=u.useState(null),[C,c]=u.useState(""),S=s=>{f(s.id),c(s.paidAmount.toString())},v=s=>{C!==""&&!isNaN(parseFloat(C))&&h&&(h(s,{paidAmount:parseFloat(C)}),f(null))},I=(s,D)=>{h&&(h(s,{paidAmount:D}),f(null))};return e.jsx(re,{disableTilt:!0,className:"flex-1 flex flex-col bg-white dark:bg-[#1a1c22] rounded-4xl shadow-sm overflow-hidden border border-transparent dark:border-white/5 transition-colors duration-300",children:e.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar p-2 [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"text-xs text-gray-500 dark:text-gray-400 font-bold uppercase border-b border-gray-100 dark:border-white/5 sticky top-0 bg-white dark:bg-[#1a1c22] z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3 pr-4 pt-3 text-right",children:"العميل"}),e.jsx("th",{className:"pb-3 pt-3 text-right",children:"المصدر"}),e.jsx("th",{className:"pb-3 pt-3 text-right",children:"التاريخ"}),e.jsx("th",{className:"pb-3 pt-3 text-right",children:"التفاصيل (كلي/مدفوع/باقي)"}),e.jsx("th",{className:"pb-3 pl-4 text-left pt-3",children:"العربون"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-white/5",children:k.map((s,D)=>e.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-white/5 transition-colors",children:[e.jsxs("td",{className:"py-2 pr-4 font-medium text-gray-900 dark:text-gray-200",children:[s.title,e.jsx("span",{className:"block text-[10px] text-gray-400 font-normal",children:s.clientName})]}),e.jsx("td",{className:"py-2",children:(()=>{const o=(s.category||"").toLowerCase()==="location";return e.jsx("span",{className:`text-[9px] px-2 py-0.5 rounded-full font-bold border ${o?"bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 border-amber-100 dark:border-amber-900/30":"bg-violet-50 dark:bg-violet-900/20 text-violet-600 dark:text-violet-400 border-violet-100 dark:border-violet-900/30"}`,children:o?"فيلا حداد":"سرى الحداد"})})()}),e.jsx("td",{className:"py-2 text-sm text-gray-500 dark:text-gray-400 font-mono",children:s.shootDate?s.shootDate.split("T")[0]:"-"}),e.jsx("td",{className:"py-2",children:(()=>{const o=s,p=o.originalPackagePrice||s.totalAmount,j=o.addOnTotal||0,U=(o.paymentRecords||[]).filter(w=>w.currency&&w.currency!==s.currency).reduce((w,E)=>w+(E.amount||0),0)>0,N=s.currency==="USD"?"د.ع":"$";return e.jsxs("div",{className:"flex flex-col gap-0.5 text-[10px]",children:[e.jsxs("div",{className:"flex justify-between gap-4 text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:"الكلي:"}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"font-mono text-gray-900 dark:text-gray-300",children:U?V(p,s.currency):V(s.totalAmount,s.currency)}),U&&j>0&&e.jsxs("span",{className:"font-mono text-blue-600 dark:text-blue-400 text-[9px]",children:["+ ",j.toLocaleString()," ",N]})]})]}),e.jsxs("div",{className:"flex justify-between gap-4 text-emerald-600 dark:text-emerald-400 font-bold group/paid relative",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"المدفوع:"}),h&&!$&&e.jsx("button",{onClick:()=>S(s),className:"opacity-0 group-hover/paid:opacity-100 text-gray-400 hover:text-emerald-500 transition-all p-0.5",children:e.jsx(pe,{size:10})})]}),$===s.id?e.jsxs("div",{className:"flex items-center gap-1 animate-in zoom-in-95 duration-200",children:[e.jsx("input",{type:"number",className:"w-20 h-5 text-[10px] bg-white dark:bg-black/50 border border-emerald-300 dark:border-emerald-500/50 rounded px-1 outline-none text-left font-mono text-gray-900 dark:text-white",value:C,onChange:w=>c(w.target.value),autoFocus:!0,onKeyDown:w=>w.key==="Enter"&&v(s.id)}),e.jsx("button",{onClick:()=>I(s.id,s.totalAmount),className:"text-[8px] bg-emerald-500 text-white px-1 rounded hover:bg-emerald-600 transition-colors",title:"دفع كامل المبلغ",children:"كامل"}),e.jsx("button",{onClick:()=>v(s.id),className:"text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 rounded p-0.5",children:e.jsx(me,{size:12})}),e.jsx("button",{onClick:()=>f(null),className:"text-rose-400 hover:bg-rose-50 dark:hover:bg-rose-900/30 rounded p-0.5",children:e.jsx(be,{size:12})})]}):e.jsx("span",{className:"font-mono",children:V(s.paidAmount,s.currency)})]}),e.jsxs("div",{className:"flex justify-between gap-4 text-rose-500 dark:text-rose-400 font-bold border-t border-gray-50 dark:border-white/5 mt-0.5 pt-0.5",children:[e.jsx("span",{children:"المتبقي:"}),e.jsx("span",{className:"font-mono",children:V(s.totalAmount-s.paidAmount,s.currency)})]})]})})()}),e.jsx("td",{className:"py-2 pl-4 text-left",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:`font-black font-mono ${s.currency==="USD"?"text-amber-600 dark:text-amber-400":"text-gray-900 dark:text-white"} text-sm`,children:V(s.paidAmount,s.currency)}),(()=>{const p=(s.paymentRecords||[]).filter(j=>j.currency&&j.currency!==s.currency).reduce((j,z)=>j+(z.amount||0),0);return p>0?e.jsxs("span",{className:"text-[9px] font-mono text-blue-500 dark:text-blue-400 font-bold",children:["+ ",p.toLocaleString()," ",s.currency==="USD"?"د.ع":"$"]}):null})()]})})]},s.id))}),e.jsx("tfoot",{className:"border-t-2 border-gray-100 dark:border-white/5 bg-gray-50/50 dark:bg-black/20",children:(()=>{const s=k.filter(o=>o.currency==="USD").reduce((o,p)=>o+(p.paidAmount||0),0),D=k.filter(o=>o.currency!=="USD").reduce((o,p)=>o+(p.paidAmount||0),0);return e.jsxs("tr",{className:"font-black text-gray-900 dark:text-gray-200",children:[e.jsx("td",{colSpan:2,className:"py-4 pr-4 text-right text-xs",children:"الإجمالي لهذا العرض:"}),e.jsxs("td",{className:"py-4 text-xs font-mono",children:[k.length," حجز"]}),e.jsx("td",{className:"py-4"}),e.jsx("td",{className:"py-4 pl-4 text-left font-black",children:e.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[s>0&&e.jsxs("span",{className:"text-sm font-mono text-amber-600 dark:text-amber-400",children:["$",s.toLocaleString()]}),D>0&&e.jsxs("span",{className:"text-sm font-mono text-emerald-700 dark:text-emerald-400",children:[D.toLocaleString()," د.ع"]})]})})]})})()})]})})})},Pe=J.memo(Re),_e=({expenses:k,onAddExpense:h,onDeleteExpense:m,disableTilt:$=!1})=>{const[f,C]=u.useState("expenses"),[c,S]=u.useState(""),[v,I]=u.useState("IQD"),[s,D]=u.useState("other"),[o,p]=u.useState(""),[j,z]=u.useState(""),[_,U]=u.useState(1),[N,w]=u.useState([]);u.useEffect(()=>{E()},[]);const E=async()=>{try{const t=await R.getRecurringExpenses();w(t)}catch(t){console.error("Failed to load recurring expenses:",t)}},l=t=>{t.preventDefault(),!(!c||!o)&&(h==null||h({title:o,amount:parseFloat(c),currency:v,category:s,date:new Date().toISOString(),note:j}),S(""),p(""),z(""))},F=async t=>{if(t.preventDefault(),!(!c||!o))try{await R.addRecurringExpense({title:o,amount:parseFloat(c),currency:v,category:s,dayOfMonth:_,isActive:!0}),await E(),S(""),p(""),U(1)}catch(x){console.error("Failed to add recurring expense:",x)}},Z=async t=>{try{await R.deleteRecurringExpense(t),await E()}catch(x){console.error("Failed to delete recurring expense:",x)}},Q=u.useMemo(()=>{const t=k.reduce((g,d)=>g+(d.currency==="USD"?d.amount:0),0),x=k.reduce((g,d)=>g+(d.currency!=="USD"?d.amount:0),0);return{usd:t,iqd:x}},[k]),T=u.useMemo(()=>{const t=N.reduce((g,d)=>g+(d.currency==="USD"?d.amount:0),0),x=N.reduce((g,d)=>g+(d.currency!=="USD"?d.amount:0),0);return{usd:t,iqd:x}},[N]),a=["rent","salaries","equipment","marketing","services","other"];return e.jsxs(re,{variant:"light",disableTilt:$,className:"h-full flex flex-col bg-white dark:bg-[#1a1c22] rounded-4xl shadow-sm overflow-hidden border border-transparent dark:border-white/5 transition-colors duration-300",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-white/5 flex justify-between items-center bg-gray-50/50 dark:bg-black/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx("div",{className:"p-2 bg-rose-100 dark:bg-rose-900/20 text-rose-600 dark:text-rose-400 rounded-lg",children:e.jsx(fe,{size:18})}),e.jsx("h3",{className:"font-bold text-sm",children:"المصروفات"})]}),e.jsxs("div",{className:"text-right",children:[Q.usd+T.usd>0&&e.jsxs("span",{className:"block text-lg font-black text-rose-600 dark:text-rose-500 font-mono",children:["$",(Q.usd+T.usd).toLocaleString()]}),Q.iqd+T.iqd>0&&e.jsxs("span",{className:"block text-lg font-black text-rose-600 dark:text-rose-500 font-mono",children:[(Q.iqd+T.iqd).toLocaleString()," ",e.jsx("span",{className:"text-xs",children:"د.ع"})]}),Q.usd+T.usd===0&&Q.iqd+T.iqd===0&&e.jsx("span",{className:"block text-xl font-black text-rose-600 dark:text-rose-500 font-mono",children:"0"}),e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500",children:"إجمالي المصروفات"})]})]}),e.jsx("div",{className:"px-4 pt-3",children:e.jsxs("div",{className:"flex p-1 rounded-xl bg-gray-100 dark:bg-black/40 border border-gray-200 dark:border-white/5",children:[e.jsxs("button",{onClick:()=>C("expenses"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1.5 ${f==="expenses"?"bg-rose-600 text-white shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[e.jsx(X,{size:14})," مصروفات عادية"]}),e.jsxs("button",{onClick:()=>C("recurring"),className:`flex-1 py-2 text-xs font-bold rounded-lg transition-all flex items-center justify-center gap-1.5 ${f==="recurring"?"bg-blue-600 text-white shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[e.jsx(ee,{size:14})," مصروفات ثابتة"]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row h-full overflow-hidden",children:[e.jsx("div",{className:"w-full md:w-[38%] p-4 border-l border-gray-100 dark:border-white/5 overflow-y-auto bg-gray-50/30 dark:bg-black/10",children:f==="expenses"?e.jsxs("form",{onSubmit:l,className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"عنوان المصروف"}),e.jsx("input",{type:"text",value:o,onChange:t=>p(t.target.value),className:"w-full px-3 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-rose-500/20 focus:border-rose-500 outline-none transition-all placeholder-gray-400 dark:placeholder-gray-600",placeholder:"مثلاً: تنظيف الاستوديو"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"المبلغ"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:c,onChange:t=>S(t.target.value),className:"w-full pl-3 pr-8 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-rose-500/20 focus:border-rose-500 outline-none transition-all font-mono placeholder-gray-400 dark:placeholder-gray-600",placeholder:"0.00"}),e.jsx("span",{className:"absolute right-3 top-2 text-gray-400",children:e.jsx(te,{size:10})})]})]}),e.jsxs("div",{className:"w-1/3",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"العملة"}),e.jsxs("select",{value:v,onChange:t=>I(t.target.value),className:"w-full px-2 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-rose-500/20 focus:border-rose-500 outline-none transition-all",children:[e.jsx("option",{value:"IQD",children:"IQD"}),e.jsx("option",{value:"USD",children:"USD"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-1 block",children:"الفئة"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.map(t=>e.jsx("button",{type:"button",onClick:()=>D(t),className:`px-2 py-1 rounded-md text-[9px] font-bold border transition-colors ${s===t?"bg-rose-600 text-white border-rose-600 shadow-sm":"bg-white dark:bg-black/50 text-gray-500 dark:text-gray-400 border-gray-200 dark:border-white/10 hover:bg-gray-50 dark:hover:bg-white/10"}`,children:G[t]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 mb-1 block",children:"ملاحظات"}),e.jsx("textarea",{value:j,onChange:t=>z(t.target.value),className:"w-full px-3 py-2 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-xl text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-rose-500/20 focus:border-rose-500 outline-none transition-all resize-none placeholder-gray-400 dark:placeholder-gray-600",rows:2,placeholder:"تفاصيل إضافية..."})]}),e.jsxs("button",{type:"submit",disabled:!o||!c,className:`w-full py-2.5 rounded-xl flex items-center justify-center gap-2 font-bold text-xs transition-all ${!o||!c?"bg-gray-100 dark:bg-white/5 text-gray-400 cursor-not-allowed":"bg-rose-600 text-white shadow-lg shadow-rose-600/30 hover:shadow-rose-600/40 transform hover:-translate-y-0.5"}`,children:[e.jsx(ae,{size:16}),"إضافة مصروف"]})]}):e.jsxs("form",{onSubmit:F,className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"عنوان المصروف الثابت"}),e.jsx("input",{type:"text",value:o,onChange:t=>p(t.target.value),className:"w-full px-3 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all placeholder-gray-400 dark:placeholder-gray-600",placeholder:"مثلاً: إيجار الستوديو"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"المبلغ الشهري"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:c,onChange:t=>S(t.target.value),className:"w-full pl-3 pr-8 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all font-mono placeholder-gray-400 dark:placeholder-gray-600",placeholder:"0.00"}),e.jsx("span",{className:"absolute right-3 top-2 text-gray-400",children:e.jsx(te,{size:10})})]})]}),e.jsxs("div",{className:"w-1/3",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"العملة"}),e.jsxs("select",{value:v,onChange:t=>I(t.target.value),className:"w-full px-2 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",children:[e.jsx("option",{value:"IQD",children:"IQD"}),e.jsx("option",{value:"USD",children:"USD"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-0.5 block",children:"يوم الخصم من كل شهر"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:_,onChange:t=>U(Number(t.target.value)),className:"w-full px-3 py-1.5 bg-gray-50 dark:bg-black/50 border border-transparent dark:border-white/10 rounded-lg text-xs font-bold text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all appearance-none",children:Array.from({length:30},(t,x)=>x+1).map(t=>e.jsxs("option",{value:t,children:["يوم ",t]},t))}),e.jsx(de,{size:14,className:"absolute left-3 top-2 text-gray-400 pointer-events-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 mb-1 block",children:"الفئة"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.map(t=>e.jsx("button",{type:"button",onClick:()=>D(t),className:`px-2 py-1 rounded-md text-[9px] font-bold border transition-colors ${s===t?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white dark:bg-black/50 text-gray-500 dark:text-gray-400 border-gray-200 dark:border-white/10 hover:bg-gray-50 dark:hover:bg-white/10"}`,children:G[t]},t))})]}),e.jsxs("button",{type:"submit",disabled:!o||!c,className:`w-full py-2.5 rounded-xl flex items-center justify-center gap-2 font-bold text-xs transition-all ${!o||!c?"bg-gray-100 dark:bg-white/5 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white shadow-lg shadow-blue-600/30 hover:shadow-blue-600/40 transform hover:-translate-y-0.5"}`,children:[e.jsx(ae,{size:16}),"إضافة مصروف ثابت"]})]})}),e.jsx("div",{className:"flex-1 p-2 bg-white dark:bg-[#1a1c22] overflow-hidden flex flex-col transition-colors",children:e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-2 pr-2",children:f==="expenses"?k.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-300 dark:text-gray-600 gap-2",children:[e.jsx(X,{size:40,className:"opacity-20"}),e.jsx("span",{className:"text-xs font-bold",children:"لا توجد مصروفات مسجلة"})]}):k.map(t=>e.jsxs("div",{className:"group flex items-center justify-between p-3 rounded-xl bg-gray-50/50 dark:bg-white/5 hover:bg-rose-50/30 dark:hover:bg-rose-900/10 border border-transparent hover:border-rose-100 dark:hover:border-rose-500/20 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-10 h-10 rounded-lg bg-gray-100 dark:bg-white/10 flex items-center justify-center text-gray-400 dark:text-gray-400 group-hover:bg-rose-100 dark:group-hover:bg-rose-500/20 group-hover:text-rose-600 dark:group-hover:text-rose-400 transition-colors",children:[t.category==="salaries"&&e.jsx(X,{size:18}),t.category==="rent"&&e.jsx(ye,{size:18}),t.category==="equipment"&&e.jsx(ve,{size:18}),t.category==="marketing"&&e.jsx(ie,{size:18}),t.category==="services"&&e.jsx(je,{size:18}),t.category==="other"&&e.jsx(te,{size:18})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-800 dark:text-gray-200",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-400 mt-0.5",children:[e.jsx("span",{children:Ie(new Date(t.date),"dd MMM",{locale:Ee})}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"}),e.jsx("span",{children:G[t.category]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"block text-sm font-black text-gray-900 dark:text-white font-mono",children:["-",t.amount.toLocaleString()," ",e.jsx("span",{className:"text-[10px] text-gray-500",children:t.currency})]})}),e.jsx("button",{onClick:()=>m==null?void 0:m(t.id),className:"p-1.5 text-rose-500 dark:text-rose-400 hover:bg-rose-100 dark:hover:bg-rose-900/30 rounded-lg transition-all",children:e.jsx(se,{size:14})})]})]},t.id)):N.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-300 dark:text-gray-600 gap-2",children:[e.jsx(ee,{size:40,className:"opacity-20"}),e.jsx("span",{className:"text-xs font-bold",children:"لا توجد مصروفات ثابتة"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"أضف رواتب، اشتراكات، إيجار..."})]}):N.map(t=>e.jsxs("div",{className:"group flex items-center justify-between p-3 rounded-xl bg-blue-50/50 dark:bg-blue-900/10 hover:bg-blue-100/50 dark:hover:bg-blue-900/20 border border-blue-100 dark:border-blue-500/20 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-500/20 flex items-center justify-center text-blue-600 dark:text-blue-400",children:e.jsx(ee,{size:18})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-800 dark:text-gray-200",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-400 mt-0.5",children:[e.jsxs("span",{children:["يوم ",t.dayOfMonth," من كل شهر"]}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"}),e.jsx("span",{children:G[t.category]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"block text-sm font-black text-blue-600 dark:text-blue-400 font-mono",children:["-",t.amount.toLocaleString()," ",e.jsx("span",{className:"text-[10px] text-gray-500",children:t.currency})]}),e.jsx("span",{className:"text-[9px] text-gray-400",children:"شهرياً"})]}),e.jsx("button",{onClick:()=>Z(t.id),className:"p-1.5 text-rose-500 dark:text-rose-400 hover:bg-rose-100 dark:hover:bg-rose-900/30 rounded-lg transition-all",children:e.jsx(se,{size:14})})]})]},t.id))})})]})]})},Fe=J.memo(_e),Xe=({bookings:k,onUpdateBooking:h})=>{const[m,$]=u.useState("month"),[f,C]=u.useState("all"),[c,S]=u.useState(""),[v,I]=u.useState(!1),[s,D]=u.useState(!1),[o,p]=u.useState([]),[j,z]=u.useState([]),[_,U]=u.useState(!0),N=async()=>{try{const[a,t]=await Promise.all([R.getExpenses(),R.getRecurringExpenses()]);p(a),z(t)}catch(a){console.error(a)}finally{U(!1)}};u.useEffect(()=>{N();const a=R.subscribe(async t=>{t==="expenses_updated"&&N()});return()=>a()},[]);const w=async a=>{try{await R.addExpense(a),q.success("تم إضافة المصروف بنجاح"),N()}catch{q.error("فشل في إضافة المصروف")}},E=async a=>{try{await R.deleteExpense(a),q.success("تم حذف المصروف"),N()}catch{q.error("فشل في حذف المصروف")}},l=J.useMemo(()=>{let a=0,t=0,x=0,g=0,d=0,n=0;const L=new Date;L.getMonth(),L.getFullYear();const b=r=>{if(m==="all")return!0;if(!r)return!1;const y=new Date(r),A=new Date;if(m==="day")return y.toDateString()===A.toDateString();if(m==="week"){const B=new Date;return B.setDate(A.getDate()-7),y>=B}else{if(m==="month")return y.getMonth()===A.getMonth()&&y.getFullYear()===A.getFullYear();if(m==="year")return y.getFullYear()===A.getFullYear()}return!0},i=r=>{if(f==="all")return!0;const A=(r.category||"").toLowerCase()==="location";return f==="villa"?A:f==="sura"?!A:!0},O=r=>{if(!c)return!0;const y=c.toLowerCase();return r.clientName&&r.clientName.toLowerCase().includes(y)||r.title&&r.title.toLowerCase().includes(y)||r.clientPhone&&r.clientPhone.toString().includes(y)||r.amount&&r.amount.toString().includes(y)||r.totalAmount&&r.totalAmount.toString().includes(y)},M=k.filter(r=>!r.deletedAt&&b(r.shootDate)&&O(r)&&i(r));M.forEach(r=>{const y=r.paidAmount||0,A=(r.category||"").toLowerCase()==="location";if(A?r.currency==="USD"?x+=y:g+=y:r.currency==="USD"?a+=y:t+=y,r.addOnTotal&&r.addOnTotal>0){const B=r.currency==="USD"?"IQD":"USD";A?B==="USD"?x+=r.addOnTotal:g+=r.addOnTotal:B==="USD"?a+=r.addOnTotal:t+=r.addOnTotal}});const Y=o.filter(r=>b(r.date)&&O(r));Y.forEach(r=>{r.currency==="USD"?d+=r.amount:n+=r.amount}),j.filter(r=>r.isActive).forEach(r=>{r.currency==="USD"?d+=r.amount:n+=r.amount});const K=a+x-d,P=t+g-n;return{revenueSuraUSD:a,revenueSuraIQD:t,revenueVillaUSD:x,revenueVillaIQD:g,expensesUSD:d,expensesIQD:n,netUSD:K,netIQD:P,filteredBookings:M,filteredExpenses:Y}},[k,o,j,m,f,c]),F={day:"يومي",week:"أسبوعي",month:"شهري",year:"سنوي",all:"كامل"},Z=()=>{let a=0,t=0,x=0,g=0,d=0,n=0;const L=l.filteredBookings.map(i=>{const O=(i.category||"").toLowerCase()==="location",M=(i.totalAmount||0)-(i.paidAmount||0);return i.currency==="USD"?(a+=i.totalAmount||0,x+=i.paidAmount||0):(t+=i.totalAmount||0,g+=i.paidAmount||0),{date:i.shootDate?i.shootDate.split("T")[0]:"",source:O?"فيلا حداد":"سرى الحداد",category:i.category||"",client:i.clientName||"",phone:i.clientPhone||"",title:i.title||"",total:i.totalAmount||0,paid:i.paidAmount||0,remaining:M,currency:i.currency||"IQD",status:i.status||""}}),b=l.filteredExpenses.map(i=>(i.currency==="USD"?d+=i.amount:n+=i.amount,{date:i.date||"",title:i.title,category:i.category,amount:i.amount,currency:i.currency}));return{bookingRows:L,expenseRows:b,totalB_TotalUSD:a,totalB_TotalIQD:t,totalB_PaidUSD:x,totalB_PaidIQD:g,totalE_USD:d,totalE_IQD:n}},Q=a=>{const t=Z(),x=F[m],g=new Date().toISOString().split("T")[0],d=`تقرير_فيلا_حداد_${x}_${g}`;if(a==="csv"||a==="excel"){const n=a==="excel"?"	":",",L=["التاريخ","المصدر","النوع","العميل","الهاتف","العنوان","الكلي","المدفوع","المتبقي","العملة","الحالة"],b=[];t.bookingRows.forEach(r=>{b.push([r.date,r.source,r.category,r.client,r.phone,r.title,r.total,r.paid,r.remaining,r.currency,r.status].join(n))}),b.push(""),b.push(["","","","","","مجموع الإيرادات ($)",t.totalB_PaidUSD,"","","USD",""].join(n)),b.push(["","","","","","مجموع الإيرادات (د.ع)",t.totalB_PaidIQD,"","","IQD",""].join(n)),b.push(""),b.push(["التاريخ","مصروفات","الفئة","","","العنوان","المبلغ","","","العملة",""].join(n)),t.expenseRows.forEach(r=>{b.push([r.date,"مصروفات",r.category,"","",r.title,r.amount,"","",r.currency,""].join(n))}),b.push(""),b.push(["","","","","","مجموع المصروفات ($)",t.totalE_USD,"","","USD",""].join(n)),b.push(["","","","","","مجموع المصروفات (د.ع)",t.totalE_IQD,"","","IQD",""].join(n)),b.push(""),b.push(["","","","","","صافي الربح ($)",t.totalB_PaidUSD-t.totalE_USD,"","","USD",""].join(n)),b.push(["","","","","","صافي الربح (د.ع)",t.totalB_PaidIQD-t.totalE_IQD,"","","IQD",""].join(n));const i=[L.join(n),...b].join(`
`),O=a==="excel"?"xls":"csv",M=a==="excel"?"application/vnd.ms-excel;charset=utf-8;":"text/csv;charset=utf-8;",Y=new Blob(["\uFEFF"+i],{type:M}),K=URL.createObjectURL(Y),P=document.createElement("a");P.setAttribute("href",K),P.setAttribute("download",`${d}.${O}`),document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(K)}else if(a==="pdf"){const n=T(t,x,g),L=window.open("","_blank");L&&(L.document.write(n),L.document.close(),setTimeout(()=>L.print(),500))}D(!1),q.success(`تم تصدير تقرير (${x}) بصيغة ${a==="pdf"?"PDF":a==="excel"?"Excel":"CSV"}`)},T=(a,t,x)=>{const g=a.totalB_PaidUSD-a.totalE_USD,d=a.totalB_PaidIQD-a.totalE_IQD;return`<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8">
<title>تقرير مالي - فيلا حداد</title>
<style>
  @page { size: A4; margin: 20mm; }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Segoe UI', Tahoma, sans-serif; color: #1a1a2e; background: #fff; font-size: 11px; line-height: 1.6; }
  .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid #1a1a2e; padding-bottom: 16px; margin-bottom: 20px; }
  .logo { font-size: 28px; font-weight: 900; color: #1a1a2e; }
  .logo span { color: #e11d48; }
  .report-info { text-align: left; font-size: 10px; color: #666; }
  .report-info strong { color: #1a1a2e; font-size: 12px; }
  .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px; }
  .summary-card { border: 1px solid #e5e7eb; border-radius: 10px; padding: 14px; text-align: center; }
  .summary-card .label { font-size: 9px; color: #888; font-weight: 700; text-transform: uppercase; margin-bottom: 6px; }
  .summary-card .value { font-size: 16px; font-weight: 900; }
  .summary-card .sub { font-size: 10px; color: #666; margin-top: 2px; }
  .card-green .value { color: #059669; }
  .card-blue .value { color: #2563eb; }
  .card-amber .value { color: #d97706; }
  .card-red .value { color: #dc2626; }
  h2 { font-size: 13px; font-weight: 800; color: #1a1a2e; margin: 20px 0 8px; padding: 6px 12px; background: #f8f9fa; border-radius: 6px; border-right: 4px solid #1a1a2e; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 16px; font-size: 10px; }
  th { background: #1a1a2e; color: #fff; padding: 8px 10px; text-align: right; font-weight: 700; font-size: 9px; }
  td { padding: 7px 10px; border-bottom: 1px solid #eee; }
  tr:nth-child(even) { background: #fafafa; }
  .total-row { background: #f0f9ff !important; font-weight: 800; border-top: 2px solid #1a1a2e; }
  .total-row td { padding: 10px; }
  .currency-usd { color: #d97706; font-weight: 700; }
  .currency-iqd { color: #1a1a2e; font-weight: 700; }
  .net-section { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 24px; padding: 16px; border: 2px solid #1a1a2e; border-radius: 12px; }
  .net-box { text-align: center; padding: 12px; }
  .net-box .label { font-size: 10px; color: #666; font-weight: 700; }
  .net-box .amount { font-size: 22px; font-weight: 900; margin-top: 4px; }
  .net-positive { color: #059669; }
  .net-negative { color: #dc2626; }
  .footer { margin-top: 30px; padding-top: 12px; border-top: 1px solid #ddd; text-align: center; font-size: 9px; color: #aaa; }
  @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
</style>
</head>
<body>
  <div class="header">
    <div class="logo">فيلا <span>حداد</span></div>
    <div class="report-info">
      <strong>تقرير مالي ${t}</strong><br>
      تاريخ التقرير: ${x}<br>
      عدد الحجوزات: ${a.bookingRows.length} | المصروفات: ${a.expenseRows.length}
    </div>
  </div>

  <div class="summary-grid">
    <div class="summary-card card-green">
      <div class="label">صافي الأرباح</div>
      <div class="value">${g>=0?"":"-"}$${Math.abs(g).toLocaleString()}</div>
      <div class="sub">${d.toLocaleString()} د.ع</div>
    </div>
    <div class="summary-card card-blue">
      <div class="label">إيرادات سرى</div>
      <div class="value">$${l.revenueSuraUSD.toLocaleString()}</div>
      <div class="sub">${l.revenueSuraIQD.toLocaleString()} د.ع</div>
    </div>
    <div class="summary-card card-amber">
      <div class="label">إيرادات فيلا</div>
      <div class="value">$${l.revenueVillaUSD.toLocaleString()}</div>
      <div class="sub">${l.revenueVillaIQD.toLocaleString()} د.ع</div>
    </div>
    <div class="summary-card card-red">
      <div class="label">المصروفات</div>
      <div class="value">$${a.totalE_USD.toLocaleString()}</div>
      <div class="sub">${a.totalE_IQD.toLocaleString()} د.ع</div>
    </div>
  </div>

  <h2>الحجوزات والإيرادات</h2>
  <table>
    <thead>
      <tr><th>التاريخ</th><th>المصدر</th><th>العميل</th><th>العنوان</th><th>الكلي</th><th>المدفوع</th><th>المتبقي</th><th>العملة</th></tr>
    </thead>
    <tbody>
      ${a.bookingRows.map(n=>`<tr>
        <td>${n.date}</td>
        <td>${n.source}</td>
        <td>${n.client}</td>
        <td>${n.title}</td>
        <td>${n.total.toLocaleString()}</td>
        <td>${n.paid.toLocaleString()}</td>
        <td>${n.remaining.toLocaleString()}</td>
        <td class="${n.currency==="USD"?"currency-usd":"currency-iqd"}">${n.currency==="USD"?"$":"د.ع"}</td>
      </tr>`).join("")}
      <tr class="total-row">
        <td colspan="4">المجموع</td>
        <td>$${a.totalB_TotalUSD.toLocaleString()} | ${a.totalB_TotalIQD.toLocaleString()} د.ع</td>
        <td>$${a.totalB_PaidUSD.toLocaleString()} | ${a.totalB_PaidIQD.toLocaleString()} د.ع</td>
        <td></td><td></td>
      </tr>
    </tbody>
  </table>

  <h2>المصروفات</h2>
  <table>
    <thead>
      <tr><th>التاريخ</th><th>العنوان</th><th>الفئة</th><th>المبلغ</th><th>العملة</th></tr>
    </thead>
    <tbody>
      ${a.expenseRows.map(n=>`<tr>
        <td>${n.date?new Date(n.date).toLocaleDateString("ar-IQ"):""}</td>
        <td>${n.title}</td>
        <td>${n.category}</td>
        <td>${n.amount.toLocaleString()}</td>
        <td class="${n.currency==="USD"?"currency-usd":"currency-iqd"}">${n.currency==="USD"?"$":"د.ع"}</td>
      </tr>`).join("")}
      <tr class="total-row">
        <td colspan="3">المجموع</td>
        <td>$${a.totalE_USD.toLocaleString()} | ${a.totalE_IQD.toLocaleString()} د.ع</td>
        <td></td>
      </tr>
    </tbody>
  </table>

  <div class="net-section">
    <div class="net-box">
      <div class="label">صافي الربح (دولار)</div>
      <div class="amount ${g>=0?"net-positive":"net-negative"}">${g>=0?"":"-"}$${Math.abs(g).toLocaleString()}</div>
    </div>
    <div class="net-box">
      <div class="label">صافي الربح (دينار)</div>
      <div class="amount ${d>=0?"net-positive":"net-negative"}">${d.toLocaleString()} د.ع</div>
    </div>
  </div>

  <div class="footer">
    فيلا حداد - تقرير مالي تلقائي | ${x}
  </div>
</body>
</html>`};return e.jsxs("div",{className:"h-full flex flex-col px-4 lg:px-6 pt-0 pb-4 space-y-4 overflow-y-auto custom-scrollbar [&::-webkit-scrollbar]:hidden",dir:"rtl",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-3 bg-white dark:bg-[#1a1c22] border border-transparent dark:border-white/5 px-3 py-1.5 rounded-xl shadow-sm transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 w-full md:w-auto",children:[e.jsxs("h1",{className:"text-base font-black text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"w-7 h-7 rounded-lg bg-gray-900 dark:bg-white text-white dark:text-black flex items-center justify-center shadow-lg shadow-gray-900/20",children:e.jsx(X,{size:14})}),!v&&e.jsx("span",{className:"hidden md:inline",children:"المالية"})]}),e.jsx("div",{className:"flex-1 max-w-xs relative",children:e.jsxs(W.div,{initial:!1,animate:{width:v?"100%":"32px"},className:`flex items-center overflow-hidden h-9 rounded-lg transition-all outline-none focus:outline-none ${v?"bg-gray-100 dark:bg-white/5 px-2 ":"bg-transparent cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5"}`,onClick:()=>!v&&I(!0),children:[e.jsx("div",{className:"min-w-[16px] flex items-center justify-center text-gray-400",children:e.jsx(ke,{size:14})}),v&&e.jsx("input",{type:"text",value:c,onChange:a=>S(a.target.value),placeholder:"بحث...",autoFocus:!0,className:"w-full bg-transparent border-none text-[12px] font-bold text-gray-800 dark:text-gray-200 placeholder-gray-400 focus:ring-0 focus:outline-none outline-none px-2",onBlur:()=>!c&&I(!1)})]})})]}),e.jsx("div",{className:"flex items-center gap-2 w-full md:w-auto justify-end",children:e.jsx("button",{onClick:()=>$(m==="all"?"month":"all"),className:`px-4 py-2 border rounded-lg text-xs font-bold transition-all shadow-sm whitespace-nowrap ${m==="all"?"bg-gray-900 dark:bg-white text-white dark:text-black border-gray-900 dark:border-white shadow-gray-900/20":"bg-white dark:bg-[#1a1c22] text-gray-600 dark:text-gray-400 border-gray-200 dark:border-white/10 hover:bg-gray-50 dark:hover:bg-white/5"}`,children:m==="all"?"الكل":"الشهر"})})]}),e.jsxs(W.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},children:[e.jsx(H,{title:"صافي الأرباح",value:e.jsx("div",{className:"flex flex-col gap-3 w-full",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex flex-col border-l border-gray-100 px-1",children:[e.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-black",children:"صافي ($)"}),e.jsx("span",{className:`text-sm font-black truncate ${l.netUSD>=0?"text-gray-900":"text-rose-600"}`,children:l.netUSD<0?`-$${Math.abs(l.netUSD).toLocaleString()}`:`$${l.netUSD.toLocaleString()}`})]}),e.jsxs("div",{className:"flex flex-col px-1",children:[e.jsx("span",{className:"text-[8px] text-gray-400 uppercase font-black",children:"صافي (د.ع)"}),e.jsxs("span",{className:`text-sm font-black truncate ${l.netIQD>=0?"text-gray-700":"text-rose-600"}`,children:[l.netIQD.toLocaleString()," د.ع"]})]})]})}),variant:"wave",data:[{value:10},{value:15},{value:12},{value:20}],color:l.netUSD>=0&&l.netIQD>=0?"emerald":"rose"}),e.jsx(H,{title:"إيرادات سرى الحداد",value:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[l.revenueSuraUSD>0&&e.jsxs("span",{children:["$",l.revenueSuraUSD.toLocaleString()]}),l.revenueSuraIQD>0&&e.jsxs("span",{children:[l.revenueSuraIQD.toLocaleString()," د.ع"]}),l.revenueSuraUSD===0&&l.revenueSuraIQD===0&&e.jsx("span",{children:"0"})]}),variant:"wave",data:[{value:30},{value:45},{value:35},{value:60},{value:50},{value:75}],color:"violet"}),e.jsx(H,{title:"إيرادات فيلا حداد",value:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[l.revenueVillaUSD>0&&e.jsxs("span",{children:["$",l.revenueVillaUSD.toLocaleString()]}),l.revenueVillaIQD>0&&e.jsxs("span",{children:[l.revenueVillaIQD.toLocaleString()," د.ع"]}),l.revenueVillaUSD===0&&l.revenueVillaIQD===0&&e.jsx("span",{children:"0"})]}),variant:"wave",data:[{value:20},{value:35},{value:40},{value:30},{value:55},{value:45}],color:"amber"}),e.jsx(H,{title:"إجمالي المصروفات",value:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[l.expensesUSD>0&&e.jsxs("span",{children:["$",l.expensesUSD.toLocaleString()]}),l.expensesIQD>0&&e.jsxs("span",{children:[l.expensesIQD.toLocaleString()," د.ع"]}),l.expensesUSD===0&&l.expensesIQD===0&&e.jsx("span",{children:"0"})]}),variant:"bar",data:[{value:5},{value:8},{value:7},{value:12}],color:"rose"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 xl:grid-cols-3 gap-6 min-h-0",children:[e.jsx("div",{className:"xl:col-span-1 h-full min-h-0",children:e.jsx(Fe,{expenses:l.filteredExpenses,onAddExpense:w,onDeleteExpense:E,disableTilt:!0})}),e.jsx("div",{className:"xl:col-span-2 h-full min-h-0",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-sm h-full overflow-hidden flex flex-col border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"p-6 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("h3",{className:"font-bold text-gray-800 dark:text-white text-lg flex items-center gap-2",children:["سجل المبيعات والمعاملات",c&&e.jsxs("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300 px-2 py-0.5 rounded-full border border-yellow-200 dark:border-yellow-900",children:["نتائج البحث: ",l.filteredBookings.length]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"flex items-center gap-1 bg-gray-50 dark:bg-gray-700 p-1 rounded-xl border border-gray-100 dark:border-gray-600",children:[{id:"all",label:"الكل"},{id:"sura",label:"سرى"},{id:"villa",label:"فيلا"}].map(a=>e.jsx("button",{onClick:()=>C(a.id),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${f===a.id?a.id==="sura"?"bg-violet-600 text-white":a.id==="villa"?"bg-amber-600 text-white":"bg-white dark:bg-gray-900 text-gray-900 dark:text-white shadow-sm border border-gray-200 dark:border-gray-600":"text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100"}`,children:a.label},a.id))}),e.jsx("div",{className:"flex items-center gap-1 bg-gray-50 dark:bg-gray-700 p-1 rounded-xl border border-gray-100 dark:border-gray-600",children:[{id:"day",label:"يومي"},{id:"week",label:"أسبوعي"},{id:"month",label:"شهري"},{id:"year",label:"سنوي"},{id:"all",label:"الكل"}].map(a=>e.jsx("button",{onClick:()=>$(a.id),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${m===a.id?"bg-white dark:bg-gray-900 text-gray-900 dark:text-white shadow-sm border border-gray-200 dark:border-gray-600":"text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100"}`,children:a.label},a.id))})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("span",{className:"text-xs font-mono bg-gray-900 dark:bg-gray-700 px-3 py-1.5 rounded-lg text-white font-bold flex items-center gap-1.5",children:[e.jsx(we,{size:12}),l.filteredBookings.length," عملية"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>D(!s),className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg text-xs font-bold transition-all shadow-sm",children:[e.jsx(Ne,{size:12}),"تصدير",e.jsx(de,{size:10,className:`transition-transform ${s?"rotate-180":""}`})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>D(!1)}),e.jsxs("div",{className:"absolute left-0 top-full mt-1 z-50 bg-white dark:bg-[#1a1c22] border border-gray-200 dark:border-white/10 rounded-xl shadow-xl overflow-hidden min-w-[160px]",children:[e.jsxs("button",{onClick:()=>Q("pdf"),className:"w-full flex items-center gap-2 px-4 py-2.5 text-xs font-bold text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-white/5 transition-colors",children:[e.jsx(le,{size:14,className:"text-rose-500"}),"تصدير PDF"]}),e.jsxs("button",{onClick:()=>Q("excel"),className:"w-full flex items-center gap-2 px-4 py-2.5 text-xs font-bold text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-white/5 transition-colors",children:[e.jsx(Se,{size:14,className:"text-emerald-500"}),"تصدير Excel"]}),e.jsxs("button",{onClick:()=>Q("csv"),className:"w-full flex items-center gap-2 px-4 py-2.5 text-xs font-bold text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-white/5 transition-colors border-t border-gray-100 dark:border-white/5",children:[e.jsx(le,{size:14,className:"text-blue-500"}),"تصدير CSV"]})]})]})]})]})]}),e.jsx("div",{className:"flex-1 p-2 flex flex-col min-h-0",children:e.jsx(Pe,{bookings:l.filteredBookings,onUpdateBooking:h})})]})})]})]})};export{Xe as default};
