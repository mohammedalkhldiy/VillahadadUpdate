import{r as i,j as e}from"./vendor-react-Ce27NbrU.js";import{aQ as b,b0 as y,e as w,o as S,y as n,av as C,K as k,F as A,A as E}from"./vendor-ui-TjLGESBy.js";const I=({bookings:o,users:d})=>{const[l,f]=i.useState(""),[r,x]=i.useState("all"),[m,c]=i.useState(!1),g=i.useMemo(()=>{const t=[];return o.forEach(s=>{s.createdAt&&t.push({id:`CRE-${s.id.slice(0,4)}`,timestamp:s.createdAt,actorId:s.created_by,action:"CREATED_BOOKING",target:s.title||"Booking",targetId:s.id,severity:"info",details:`Created booking for ${s.clientName}`}),s.updated_at&&s.updated_at!==s.createdAt&&t.push({id:`UPD-${s.id.slice(0,4)}`,timestamp:s.updated_at,actorId:s.updated_by,action:"UPDATED_BOOKING",target:s.title||"Booking",targetId:s.id,severity:"medium",details:`Updated details for ${s.clientName}`}),s.statusHistory&&s.statusHistory.length>0&&s.statusHistory.forEach((a,v)=>{t.push({id:`STS-${s.id.slice(0,4)}-${v}`,timestamp:a.timestamp,actorId:a.userId,action:`STATUS: ${a.status.toUpperCase()}`,target:s.title,targetId:s.id,severity:"high",details:a.notes||`Changed status to ${a.status}`})})}),t.sort((s,a)=>new Date(a.timestamp).getTime()-new Date(s.timestamp).getTime())},[o]),p=t=>{var s;return t?((s=d.find(a=>a.id===t))==null?void 0:s.name)||t||"Unknown Staff":"System"},h=t=>{switch(t){case"critical":return"text-rose-500 bg-rose-500/10 border-rose-500/20";case"high":return"text-orange-500 bg-orange-500/10 border-orange-500/20";case"medium":return"text-amber-500 bg-amber-500/10 border-amber-500/20";default:return"text-cyan-500 bg-cyan-500/10 border-cyan-500/20"}},j=t=>t.includes("DELETE")?e.jsx(C,{size:14}):t.includes("PRICE")||t.includes("FINANCE")?e.jsx(k,{size:14}):t.includes("STATUS")?e.jsx(N,{action:t}):t.includes("CREATED")?e.jsx(A,{size:14}):e.jsx(n,{size:14}),N=({action:t})=>t.includes("CONFIRMED")?e.jsx(E,{size:14,className:"text-emerald-500"}):e.jsx(n,{size:14}),u=g.filter(t=>{const s=t.details.toLowerCase().includes(l.toLowerCase())||t.target.toLowerCase().includes(l.toLowerCase()),a=r==="all"||t.actorId===r;return s&&a});return e.jsxs("div",{className:"h-full flex flex-col animate-in fade-in duration-500 font-mono",dir:"rtl",children:[e.jsx("div",{className:"bg-[#0B0E14]/60 backdrop-blur-3xl border border-rose-500/20 rounded-4xl p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-rose-500/10 rounded-2xl text-rose-400 border border-rose-500/20 shadow-[0_0_20px_rgba(244,63,94,0.1)]",children:e.jsx(b,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white tracking-tighter uppercase",children:"سجل نشاط الموظفين"}),e.jsx("p",{className:"text-[10px] text-rose-400/50 font-mono tracking-widest uppercase",children:"Staff Activity Logs & Audit Trail"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 w-full lg:w-auto",children:[e.jsxs("div",{className:"relative z-20",children:[e.jsxs("button",{onClick:()=>c(!m),className:"flex items-center gap-2 px-4 py-2.5 bg-black/40 border border-rose-500/10 rounded-xl text-[10px] text-gray-300 hover:text-white transition-colors min-w-[140px] justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(y,{size:14,className:"text-rose-500"}),r==="all"?"كل الموظفين":p(r)]}),e.jsx(w,{size:14})]}),m&&e.jsxs("div",{className:"absolute top-full mt-2 w-full bg-[#1A1D24] border border-white/10 rounded-xl overflow-hidden shadow-2xl",children:[e.jsx("button",{onClick:()=>{x("all"),c(!1)},className:"w-full text-right px-4 py-2 text-[10px] text-gray-300 hover:bg-white/5 border-b border-white/5",children:"كل الموظفين"}),d.map(t=>e.jsxs("button",{onClick:()=>{x(t.id),c(!1)},className:"w-full text-right px-4 py-2 text-[10px] text-gray-300 hover:bg-white/5 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-700 overflow-hidden",children:t.avatar&&e.jsx("img",{src:t.avatar,className:"w-full h-full object-cover"})}),t.name]},t.id))]})]}),e.jsxs("div",{className:"relative group flex-1 lg:min-w-[300px]",children:[e.jsx(S,{className:"absolute right-4 top-2.5 text-rose-400/50 group-focus-within:text-rose-400",size:16}),e.jsx("input",{type:"text",placeholder:"بحث في السجل...",value:l,onChange:t=>f(t.target.value),className:"w-full bg-black/40 border border-rose-500/10 rounded-xl pr-10 pl-4 py-2.5 text-[10px] font-mono text-rose-50 placeholder:text-gray-700 focus:border-rose-500/50 outline-none transition-all"})]})]})]})}),e.jsxs("div",{className:"flex-1 bg-[#0B0E14]/60 border border-white/5 rounded-4xl overflow-hidden flex flex-col relative",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-8 py-4 border-b border-white/5 bg-black/20 text-[9px] font-black text-gray-500 uppercase tracking-widest sticky top-0 z-10 text-right",children:[e.jsx("div",{className:"col-span-2",children:"الوقت / التاريخ"}),e.jsx("div",{className:"col-span-2",children:"الموظف"}),e.jsx("div",{className:"col-span-3",children:"الإجراء"}),e.jsx("div",{className:"col-span-3",children:"التفاصيل"}),e.jsx("div",{className:"col-span-2 text-left",children:"الحالة"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-2 py-4 space-y-1",children:u.length>0?u.map((t,s)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center px-6 py-3 bg-white/5 border border-white/5 rounded-xl hover:bg-rose-500/5 hover:border-rose-500/20 transition-all cursor-pointer group",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-white",children:new Date(t.timestamp).toLocaleTimeString()}),e.jsx("span",{className:"text-[8px] text-gray-600 font-mono",children:new Date(t.timestamp).toLocaleDateString()})]})}),e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:"text-[10px] font-bold text-cyan-400",children:p(t.actorId)})}),e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${h(t.severity)} bg-opacity-20`,children:j(t.action)}),e.jsx("span",{className:"text-[9px] font-black uppercase text-gray-300",children:t.action})]})}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("p",{className:"text-[10px] text-gray-400 truncate",title:t.details,children:t.details}),e.jsx("p",{className:"text-[8px] text-gray-600 font-mono mt-0.5",children:t.target})]}),e.jsx("div",{className:"col-span-2 flex justify-end",children:e.jsx("span",{className:`px-2 py-1 rounded-md text-[8px] font-black uppercase tracking-widest ${h(t.severity)}`,children:t.severity})})]},s)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-500 opacity-50",children:[e.jsx(n,{size:32,className:"mb-2"}),e.jsx("p",{className:"text-xs font-mono",children:"NO_RECORDS_FOUND"})]})})]})]})};export{I as default};
