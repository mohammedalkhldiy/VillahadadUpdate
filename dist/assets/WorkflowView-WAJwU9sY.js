import{r as N,j as e}from"./vendor-react-Ce27NbrU.js";import{n as a,l as v,B as y,S as G,r as ee,t as te,D as se}from"./index-BFvmHygk.js";import{c as b}from"./utils-BykweIWy.js";import{aB as ae,l as M,A as R,af as re,P as le,aT as U,a as z,m as D,d as P,y as A,v as E,a6 as L,o as K,c as X,aF as ne,V as ie,aS as ce,b$ as de,bU as xe,ax as oe,a8 as S,aU as $,aV as C,X as pe,K as me}from"./vendor-ui-TjLGESBy.js";import{g as W,p as F}from"./vendor-utils-DKqDJWuS.js";import"./vendor-supabase-CSCOup90.js";import"./clsx-B-dksMZM.js";const I=(t,o)=>{if(!t||t.length===0)return 0;const i=[...t].reverse().find(l=>l.status===o);return i?W(new Date,F(i.timestamp)):0},he=[{status:a.CONFIRMED,title:"Upcoming",icon:e.jsx(E,{size:14}),color:"blue"},{status:a.SHOOTING,title:"Shooting",icon:e.jsx(L,{size:14}),color:"amber"},{status:a.SELECTION,title:"Selection",icon:e.jsx(K,{size:14}),color:"purple"},{status:a.EDITING,title:"Editing",icon:e.jsx(X,{size:14}),color:"pink"},{status:a.READY_TO_PRINT,title:"Printing",icon:e.jsx(ne,{size:14}),color:"orange"},{status:a.READY_FOR_PICKUP,title:"Pickup",icon:e.jsx(ie,{size:14}),color:"emerald"},{status:a.DELIVERED,title:"Delivered",icon:e.jsx(P,{size:14}),color:"green"}],ue=({bookings:t,users:o,onViewBooking:i,onStatusUpdate:l})=>{const m=N.useMemo(()=>he.map(r=>{const s=t.filter(u=>u.status===r.status),p=s.reduce((u,x)=>u+x.totalAmount,0),c=s.length>0?Math.round(s.reduce((u,x)=>u+I(x.statusHistory||[],x.status),0)/s.length):0,f=s.filter(u=>I(u.statusHistory||[],u.status)>5).length;return{...r,bookings:s,totalValue:p,avgDays:c,criticalCount:f,load:s.length}}),[t]),d=N.useMemo(()=>t.reduce((r,s)=>r+s.totalAmount,0),[t]);return e.jsxs("div",{className:"w-full h-full flex flex-col gap-6 pt-4 px-4 pb-0 bg-transparent rounded-[3rem] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 px-2 overflow-x-auto no-scrollbar py-1",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-white/80 dark:bg-[#1a1c22]/80 backdrop-blur-xl rounded-2xl shadow-sm shrink-0 min-w-[160px] border border-transparent dark:border-white/5",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100/50 dark:bg-amber-500/10 rounded-xl flex items-center justify-center text-amber-600 dark:text-amber-500 shadow-inner",children:e.jsx(ae,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[8px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-tighter leading-none mb-1",children:"Pipeline Value"}),e.jsx("h4",{className:"text-sm font-black text-gray-900 dark:text-white leading-none",children:v(d,"USD")})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-white/80 dark:bg-[#1a1c22]/80 backdrop-blur-xl rounded-2xl shadow-sm shrink-0 min-w-[160px] border border-transparent dark:border-white/5",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100/50 dark:bg-blue-500/10 rounded-xl flex items-center justify-center text-blue-600 dark:text-blue-500 shadow-inner",children:e.jsx(M,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[8px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-tighter leading-none mb-1",children:"Active Bookings"}),e.jsxs("h4",{className:"text-sm font-black text-gray-900 dark:text-white leading-none",children:[t.filter(r=>r.status!==a.DELIVERED).length," ",e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-600 font-bold ml-0.5",children:"Tracked"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-white/80 dark:bg-[#1a1c22]/80 backdrop-blur-xl rounded-2xl shadow-sm shrink-0 min-w-[160px] border border-transparent dark:border-white/5",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100/50 dark:bg-red-500/10 rounded-xl flex items-center justify-center text-red-600 dark:text-red-500 shadow-inner",children:e.jsx(R,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[8px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-tighter leading-none mb-1",children:"Urgent Alerts"}),e.jsxs("h4",{className:"text-sm font-black text-gray-900 dark:text-white leading-none",children:[t.filter(r=>I(r.statusHistory||[],r.status)>5).length," ",e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-600 font-bold ml-0.5",children:"Bottlenecks"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-white/80 dark:bg-[#1a1c22]/80 backdrop-blur-xl rounded-2xl shadow-sm shrink-0 min-w-[160px] border border-transparent dark:border-white/5",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100/50 dark:bg-emerald-500/10 rounded-xl flex items-center justify-center text-emerald-600 dark:text-emerald-500 shadow-inner",children:e.jsx(re,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[8px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-tighter leading-none mb-1",children:"Operational Load"}),e.jsxs("h4",{className:"text-sm font-black text-gray-900 dark:text-white leading-none",children:[o.length," ",e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-600 font-bold ml-0.5",children:"Engineers"})]})]})]})]}),e.jsx("div",{className:"flex-1 grid grid-cols-7 gap-3 min-h-0",children:m.map((r,s)=>{r.load>4;const p=r.criticalCount>0;return e.jsxs("div",{className:b("flex flex-col h-full rounded-[2.5rem] transition-all duration-500 overflow-hidden border border-transparent dark:border-white/5",p?"bg-white/90 dark:bg-[#1a1c22]/90 shadow-[0_8px_32px_rgba(239,68,68,0.08)] ring-1 ring-red-500/20":"bg-white/60 dark:bg-[#1a1c22]/60 backdrop-blur-md shadow-sm"),children:[e.jsx("div",{className:"relative group/header overflow-hidden",children:e.jsxs("div",{className:"pt-3 pb-2 px-3 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:b("p-1.5 rounded-lg shadow-sm text-white shrink-0",r.color==="blue"?"bg-blue-500":r.color==="amber"?"bg-amber-500":r.color==="purple"?"bg-purple-500":r.color==="pink"?"bg-pink-500":r.color==="orange"?"bg-orange-500":r.color==="emerald"?"bg-emerald-500":"bg-green-500"),children:r.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h5",{className:"text-[10px] font-black text-gray-900 dark:text-white uppercase tracking-tight truncate leading-none mb-1",children:r.title}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:"text-[8px] font-bold text-gray-300 dark:text-gray-600 uppercase tracking-widest",children:[r.load," Tasks"]}),e.jsx("div",{className:"w-0.5 h-0.5 rounded-full bg-gray-200 dark:bg-gray-700"}),e.jsx("span",{className:"text-[8px] font-black text-gray-400 dark:text-gray-500",children:v(r.totalValue,"USD")})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/header:opacity-100 transition-opacity",children:[e.jsx("button",{className:"p-1 hover:bg-gray-100 rounded-md text-gray-400 transition-colors",children:e.jsx(le,{size:12})}),e.jsx("button",{className:"p-1 hover:bg-gray-100 rounded-md text-gray-400 transition-colors",children:e.jsx(U,{size:12})})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-3 no-scrollbar pb-3",children:[e.jsx(z,{mode:"popLayout",children:r.bookings.map(c=>e.jsxs(D.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>i(c.id),className:b("group relative p-3 rounded-2xl transition-all cursor-pointer bg-white/40 dark:bg-[#000]/20 hover:bg-white/80 dark:hover:bg-[#252830] hover:shadow-xl border border-transparent dark:border-white/5",I(c.statusHistory||[],c.status)>5?"ring-1 ring-red-500/20":""),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:b("px-2 py-0.5 rounded-md text-[7px] font-black uppercase",c.category===y.WEDDING?"bg-purple-100 text-purple-600":"bg-blue-100 text-blue-600"),children:c.category}),e.jsx("span",{className:"px-2 py-0.5 rounded-md text-[7px] font-black uppercase bg-gray-100 text-gray-500",children:c.currency})]}),e.jsx("button",{className:"p-1 hover:bg-gray-100 rounded-md text-gray-300 transition-colors",children:e.jsx(U,{size:10})})]}),e.jsx("h6",{className:"text-[10px] font-black text-gray-900 dark:text-gray-200 mb-2 leading-tight group-hover:text-amber-600 dark:group-hover:text-amber-400 transition-colors",children:c.title}),e.jsxs("div",{className:"flex items-center justify-between pt-2 mt-2",children:[e.jsx("div",{className:"flex -space-x-1",children:e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center text-[7px] font-black shadow-sm",children:c.clientName.charAt(0)})}),e.jsx("div",{className:"flex items-center gap-2"})]}),I(c.statusHistory||[],c.status)>5&&e.jsx("div",{className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-md shadow-sm",children:e.jsx(R,{size:8})})]},c.id))}),r.bookings.length===0&&e.jsx("div",{className:"h-full flex flex-col items-center justify-center opacity-10",children:e.jsx(P,{size:24,className:"text-gray-400"})})]}),e.jsxs("div",{className:"p-3 bg-transparent flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(A,{size:10,className:"text-gray-400"}),e.jsxs("span",{className:"text-[8px] font-black text-gray-500 uppercase",children:["Avg ",r.avgDays,"D"]})]}),p&&e.jsxs("div",{className:"animate-pulse flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),e.jsx("span",{className:"text-[8px] font-black text-red-600 uppercase",children:"Alert"})]})]})]},r.title)})})]})},q=(t,o)=>{if(!t||t.length===0)return 0;const i=[...t].reverse().find(l=>l.status===o);return i?W(new Date,F(i.timestamp)):0},B=(t,o)=>{let i;switch(t.status){case a.SHOOTING:i=t.assignedShooter;break;case a.EDITING:i=t.assignedPhotoEditor||t.assignedVideoEditor;break;case a.READY_TO_PRINT:i=t.assignedPrinter;break;case a.CONFIRMED:case a.SELECTION:case a.READY_FOR_PICKUP:case a.DELIVERED:i=t.assignedReceptionist;break}return o.find(l=>l.id===i)},Q=20,ge=({children:t,className:o="",onClick:i,onDragStart:l,draggable:m,disableTilt:d=!1})=>{const r=N.useRef(null),s=S(0),p=S(0),c=S(0),f=S(0),u=$(s,{stiffness:150,damping:20}),x=$(p,{stiffness:150,damping:20}),h=C`perspective(1200px) rotateX(${u}deg) rotateY(${x}deg)`,n=C`radial-gradient(250px circle at ${c}px ${f}px, rgba(251, 191, 36, 0.8) 0%, transparent 100%)`,g=C`radial-gradient(350px circle at ${c}px ${f}px, rgba(251, 191, 36, 0.08), transparent 70%)`,j=C`linear-gradient(${c}deg, transparent, rgba(255,255,255,0.1), transparent)`,k=O=>{if(!r.current)return;const w=r.current.getBoundingClientRect(),H=w.width,T=w.height,V=O.clientX-w.left,Y=O.clientY-w.top;c.set(V),f.set(Y);const J=d?0:(Y/T-.5)*Q*-1,Z=d?0:(V/H-.5)*Q;s.set(J),p.set(Z)},_=()=>{s.set(0),p.set(0)};return e.jsxs(D.div,{ref:r,onMouseMove:k,onMouseLeave:_,onClick:i,onDragStart:l,draggable:m,style:{transform:h},initial:{opacity:0,y:30,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.9,transition:{duration:.2}},whileHover:{y:-5,transition:{duration:.2}},className:b("relative group rounded-4xl bg-white dark:bg-[#1a1c22] shadow-[0_8px_30px_rgb(0,0,0,0.04)] dark:shadow-black/20 overflow-hidden transition-all duration-300","hover:shadow-[0_30px_60px_-15px_rgba(0,0,0,0.12)]",o),children:[e.jsx(D.div,{className:"pointer-events-none absolute inset-0 z-0 opacity-0 group-hover:opacity-100 transition-opacity duration-700",style:{background:g}}),e.jsx(D.div,{className:"pointer-events-none absolute inset-0 z-1 opacity-0 group-hover:opacity-100 transition-opacity duration-500",style:{background:j}}),e.jsx(D.div,{className:"pointer-events-none absolute inset-0 z-10 rounded-4xl opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{maskImage:n,WebkitMaskImage:n}}),e.jsx("div",{className:"absolute inset-0 z-0 bg-linear-to-tr from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"relative z-20 h-full p-3.5",children:t})]})},fe=({bookings:t,users:o,onViewBooking:i,onStatusUpdate:l})=>{const m=[a.CONFIRMED,a.SHOOTING,a.SELECTION,a.CLIENT_DELAY,a.EDITING,a.READY_TO_PRINT,a.READY_FOR_PICKUP,a.DELIVERED];return e.jsx("div",{className:"flex h-full overflow-x-auto no-scrollbar gap-8 px-8 pb-2 pt-4",dir:"rtl",children:m.map(d=>{const r=t.filter(s=>s.status===d);return e.jsxs("div",{className:"flex flex-col gap-6 min-w-[412px] max-w-[412px] h-full",onDragOver:s=>s.preventDefault(),onDrop:s=>{s.preventDefault();const p=s.dataTransfer.getData("bookingId");p&&l&&l(p,d)},children:[e.jsxs("div",{className:"flex items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.5)]"}),e.jsx("h3",{className:"text-sm font-black text-gray-900 dark:text-white uppercase tracking-widest",children:G[d]})]}),e.jsxs("span",{className:"px-2.5 py-1 bg-white/50 backdrop-blur-md rounded-lg text-[10px] font-black text-gray-500 shadow-sm border border-white",children:[r.length," Ù…Ù‡Ø§Ù…"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar space-y-7 pr-1",children:e.jsx(z,{mode:"popLayout",children:r.length>0?r.map(s=>{var f,u,x,h,n;const p=B(s,o),c=q(s.statusHistory||[],s.status);return e.jsx(ge,{draggable:!0,onDragStart:g=>{g.dataTransfer.setData("bookingId",s.id),g.dataTransfer.effectAllowed="move"},onClick:()=>{s.status===a.CONFIRMED?i(s.id,"client"):s.status===a.DELIVERED?i(s.id,"workflow"):i(s.id,"financials")},className:"h-fit cursor-grab active:cursor-grabbing",children:e.jsxs("div",{className:"flex flex-col gap-[10.5px]",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col gap-[4.5px] text-right flex-1",children:[e.jsxs("div",{className:"flex items-center gap-[4.5px] justify-end",children:[s.isFamous&&e.jsx("span",{className:"flex items-center gap-1 bg-amber-100 text-amber-600 px-[4.5px] py-1 rounded-md text-[8.1px] font-black border border-amber-200",children:"ðŸ‘‘ FAMOUS"}),s.isVIP&&e.jsx("span",{className:"flex items-center gap-1 bg-gray-900 text-white px-[4.5px] py-1 rounded-md text-[8.1px] font-black",children:"âœ¨ VIP"}),((f=s.details)==null?void 0:f.isPrivate)&&e.jsx("span",{className:"flex items-center gap-1 bg-rose-50 text-rose-600 px-[4.5px] py-1 rounded-md text-[8.1px] font-black border border-rose-100",children:"ðŸ”’ PRIVATE"})]}),e.jsxs("div",{className:"flex items-center gap-[4.5px] justify-end mt-0.5",children:[c>5&&e.jsxs("span",{className:"flex items-center gap-1 text-red-500 text-[8.1px] font-black animate-pulse",children:[e.jsx(R,{size:8.1}),"DELAYED"]}),e.jsx("span",{className:b("px-[4.5px] py-1 text-[8.1px] font-black uppercase tracking-wider rounded-md",s.category===y.WEDDING?"bg-purple-100 text-purple-600 border border-purple-200":"bg-blue-100 text-blue-600 border border-blue-200"),children:s.category===y.LOCATION?"Venue":s.category})]}),e.jsx("h3",{className:"text-gray-900 font-black text-[14.8px] leading-tight uppercase mt-0.5 line-clamp-1",children:s.title}),e.jsxs("p",{className:"text-[9.1px] text-gray-400 font-bold flex items-center gap-1 uppercase justify-end",children:[s.shootDate,e.jsx(E,{size:8.1,className:"text-amber-500"})]})]}),e.jsx("div",{className:"flex flex-col items-end gap-1.25 text-left ml-[12.5px]",children:e.jsx("div",{className:b("w-[40.5px] h-[40.5px] rounded-xl flex items-center justify-center text-sm font-black text-white shadow-md transition-transform duration-500 group-hover:rotate-6",s.category===y.WEDDING?"bg-black":s.category===y.LOCATION?"bg-amber-600":"bg-gray-800"),children:s.clientName.charAt(0)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-[12.5px] gap-y-[8.5px] py-[7px] border-y border-gray-100/50",children:[e.jsxs("div",{className:"space-y-[7px] text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[7.6px] font-black text-gray-400 uppercase tracking-tighter",children:"Ø§Ù„Ø¹Ù…ÙŠÙ„"}),e.jsx("p",{className:"text-[10.1px] font-black text-gray-900 truncate",children:s.clientName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[7.6px] font-black text-gray-400 uppercase tracking-tighter",children:"Ø§Ù„Ø¨Ø§Ù‚Ø©"}),e.jsx("p",{className:"text-[10.1px] font-black text-gray-700 line-clamp-1",children:s.servicePackage})]})]}),e.jsxs("div",{className:"space-y-[7px] text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[7.6px] font-black text-gray-400 uppercase tracking-tighter",children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("p",{className:"text-[10.1px] font-black text-amber-600 truncate",children:G[s.status]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[7.6px] font-black text-gray-400 uppercase tracking-tighter",children:"Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„"}),e.jsx("p",{className:"text-[10.1px] font-black text-gray-700 truncate",children:(p==null?void 0:p.name)||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"})]})]})]}),e.jsxs("div",{className:"bg-gray-50/50 rounded-xl p-[7px] flex flex-wrap gap-x-[12.5px] gap-y-1 justify-end",children:[((u=s.details)==null?void 0:u.hallName)&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[9.1px] font-black text-gray-600",children:s.details.hallName}),e.jsx(oe,{size:8.1,className:"text-gray-400 shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:"text-[9.1px] font-black text-gray-600",children:[(x=s.details)==null?void 0:x.startTime," - ",(h=s.details)==null?void 0:h.endTime]}),e.jsx(A,{size:8.1,className:"text-gray-400"})]}),((n=s.details)==null?void 0:n.isPhotographer)&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[9.1px] font-black text-emerald-600",children:"Ù…ØµÙˆØ±"}),e.jsx(L,{size:8.1,className:"text-emerald-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-[7px]",children:[e.jsxs("div",{className:"flex gap-[14px]",children:[e.jsx("p",{className:"text-[9.8px] font-black text-gray-900",children:v(s.totalAmount,s.currency)}),e.jsx("p",{className:"text-[9.8px] font-black text-green-600",children:v(s.paidAmount,s.currency)})]}),e.jsxs("div",{className:"flex items-center gap-1 px-[8.5px] py-[3.25px] bg-amber-50 rounded-2xl border border-amber-100/50",children:[e.jsx(M,{size:8.1,className:"text-amber-500"}),e.jsxs("span",{className:"text-[8.6px] font-black text-amber-700",children:[c," ÙŠÙˆÙ…"]})]})]})]})},s.id)}):e.jsx("div",{className:"flex flex-col items-center justify-center h-32 border-2 border-dashed border-gray-100 rounded-4xl bg-gray-50/30",children:e.jsx("p",{className:"text-[9px] font-black text-gray-300 uppercase tracking-widest",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…"})})})})]},d)})})},be=({bookings:t,users:o,onViewBooking:i})=>e.jsx("div",{className:"flex flex-col gap-2 p-6 h-full overflow-y-auto no-scrollbar",dir:"rtl",children:t.length>0?t.sort((l,m)=>new Date(l.shootDate).getTime()-new Date(m.shootDate).getTime()).map(l=>{var r;const m=B(l,o),d=q(l.statusHistory||[],l.status);return e.jsxs(D.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},onClick:()=>i(l.id),className:"flex items-center gap-6 p-3 bg-white/60 dark:bg-[#1a1c22]/60 hover:bg-white/90 dark:hover:bg-[#1a1c22]/90 backdrop-blur-xl rounded-2xl border border-white dark:border-white/5 transition-all cursor-pointer group",children:[e.jsx("div",{className:b("w-1 h-10 rounded-full",l.status===a.DELIVERED?"bg-emerald-400":l.status===a.SHOOTING?"bg-amber-400":"bg-gray-200")}),e.jsx("div",{className:b("w-10 h-10 rounded-xl flex items-center justify-center text-sm font-black text-white shadow-sm",l.category===y.WEDDING?"bg-black":l.category===y.LOCATION?"bg-amber-600":"bg-gray-800"),children:l.clientName.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0 text-right",children:[e.jsx("h4",{className:"text-[13px] font-black text-gray-900 dark:text-white uppercase truncate leading-tight",children:l.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 justify-end",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:l.clientName}),e.jsx("span",{className:"w-1 h-1 bg-gray-200 rounded-full"}),e.jsx("span",{className:b("text-[9px] font-black uppercase px-1.5 py-0.5 rounded",l.category===y.WEDDING?"bg-purple-50 text-purple-600":l.category===y.LOCATION?"bg-amber-50 text-amber-600":"bg-blue-50 text-blue-600"),children:l.category===y.LOCATION?"Venue":l.category})]})]}),e.jsxs("div",{className:"flex flex-col items-end min-w-[120px]",children:[e.jsxs("p",{className:"text-[11px] font-black text-gray-700 flex items-center gap-1.5 uppercase",children:[l.shootDate,e.jsx(E,{size:12,className:"text-amber-500"})]}),e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase mt-0.5",children:((r=l.details)==null?void 0:r.hallName)||"Ù…ÙˆÙ‚Ø¹ Ø®Ø§Ø±Ø¬ÙŠ"})]}),e.jsxs("div",{className:"flex items-center gap-3 min-w-[140px] justify-end",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-900 dark:text-gray-200 leading-none",children:(m==null?void 0:m.name)||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}),e.jsx("p",{className:"text-[8px] font-bold text-gray-400 uppercase mt-1",children:"Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„"})]}),e.jsx("div",{className:b("w-8 h-8 rounded-full flex items-center justify-center text-[10px] font-black text-white shadow-sm",(m==null?void 0:m.avatar)||"bg-gray-900"),children:m?m.name.charAt(0):"?"})]}),e.jsxs("div",{className:"flex items-center gap-6 min-w-[180px] justify-end",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[11px] font-black text-emerald-600 leading-none",children:v(l.totalAmount,l.currency)}),e.jsxs("div",{className:"flex items-center gap-1 justify-end mt-1",children:[e.jsx(M,{size:10,className:"text-amber-500"}),e.jsxs("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:[d," ÙŠÙˆÙ…"]})]})]}),e.jsx("div",{className:b("px-3 py-1.5 rounded-xl text-[9px] font-black uppercase tracking-widest min-w-[110px] text-center","bg-gray-50 text-gray-400 group-hover:bg-amber-100 group-hover:text-amber-600 transition-colors border border-transparent group-hover:border-amber-200"),children:G[l.status]})]})]},l.id)}):e.jsx("div",{className:"flex flex-col items-center justify-center h-64 border-2 border-dashed border-gray-100 rounded-[2.5rem] bg-gray-50/30",children:e.jsx("p",{className:"text-[11px] font-black text-gray-300 uppercase tracking-[0.2em]",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù…Ø·Ø§Ø¨Ù‚Ø©"})})}),je=({bookings:t,users:o,onViewBooking:i,onStatusUpdate:l,isManager:m=!1})=>{const[d,r]=N.useState("monthly"),[s,p]=N.useState(""),[c,f]=N.useState("kanban"),u=new Date;u.setHours(0,0,0,0);const x=n=>{const g=new Date(n);if(g.setHours(0,0,0,0),d==="daily")return g.getTime()===u.getTime();if(d==="weekly"){const j=new Date(u);return j.setDate(u.getDate()+7),g>=u&&g<=j}if(d==="monthly"){const j=new Date(u);return j.setMonth(u.getMonth()+1),g>=u&&g<=j}return!0},h=n=>{if(!s)return!0;const g=s.toLowerCase(),j=n.clientName||"",k=n.title||"";return j.toLowerCase().includes(g)||k.toLowerCase().includes(g)};return t.filter(n=>n.status===a.CONFIRMED&&x(n.shootDate)&&h(n)),t.filter(n=>n.status===a.SHOOTING&&x(n.shootDate)&&h(n)),t.filter(n=>n.status===a.SELECTION&&x(n.shootDate)&&h(n)),t.filter(n=>n.status===a.EDITING&&x(n.shootDate)&&h(n)),t.filter(n=>n.status===a.READY_TO_PRINT&&x(n.shootDate)&&h(n)),t.filter(n=>n.status===a.READY_FOR_PICKUP&&x(n.shootDate)&&h(n)),t.filter(n=>n.status===a.DELIVERED&&x(n.shootDate)&&h(n)),e.jsxs("div",{className:"h-full flex flex-col pt-6 px-6 pb-0 bg-transparent relative overflow-hidden",dir:"rtl",children:[e.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-40",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-amber-200/40 blur-[120px] rounded-full animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-orange-100/30 blur-[120px] rounded-full"}),e.jsx("div",{className:"absolute top-[20%] right-[10%] w-[30%] h-[30%] bg-purple-100/20 blur-[100px] rounded-full"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-6 mb-4 relative z-10 px-6 py-3 bg-white/40 dark:bg-[#1a1c22]/40 backdrop-blur-2xl rounded-2xl shadow-sm border-none",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-6 bg-amber-500 rounded-full shadow-sm"}),e.jsx("h2",{className:"text-xl font-black text-gray-900 dark:text-white tracking-tight",children:"Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„"})]}),e.jsxs("div",{className:"flex items-center p-1 bg-gray-100/50 dark:bg-white/5 rounded-xl",children:[e.jsx("button",{onClick:()=>f("kanban"),className:b("p-2 rounded-lg transition-all",c==="kanban"?"bg-white dark:bg-[#1a1c22] text-gray-900 dark:text-white shadow-sm scale-110":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"),title:"Photo Group",children:e.jsx(ce,{size:14})}),e.jsx("button",{onClick:()=>f("pulse"),className:b("p-2 rounded-lg transition-all mx-1",c==="pulse"?"bg-white dark:bg-[#1a1c22] text-amber-500 shadow-sm scale-110":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"),title:"Table View",children:e.jsx(de,{size:14})}),e.jsx("button",{onClick:()=>f("list"),className:b("p-2 rounded-lg transition-all",c==="list"?"bg-white dark:bg-[#1a1c22] text-blue-500 shadow-sm scale-110":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"),title:"List View",children:e.jsx(xe,{size:14})})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex p-0.5 bg-white/40 dark:bg-white/5 rounded-xl",children:["daily","weekly","monthly"].map(n=>e.jsx("button",{onClick:()=>r(n),className:b("px-3 py-1 rounded-lg text-[9px] font-black uppercase transition-all",d===n?"bg-gray-900 text-white shadow-md":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"),children:n},n))}),e.jsx("div",{className:"w-px h-4 bg-gray-200 dark:bg-white/10"}),e.jsxs("div",{className:"relative group",children:[e.jsx(K,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-amber-500 transition-colors",size:14}),e.jsx("input",{type:"text",value:s,onChange:n=>p(n.target.value),placeholder:"Search...",className:"h-8 w-36 bg-white/80 dark:bg-white/5 border border-white dark:border-white/5 rounded-xl pr-9 pl-3 text-[10px] font-bold dark:text-gray-200 focus:ring-2 focus:ring-amber-500/10 focus:border-amber-400 outline-none transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"})]})]})]}),e.jsx("div",{className:"flex-1 min-h-0 relative z-10 px-1 overflow-hidden",children:c==="pulse"?e.jsx(ue,{bookings:t.filter(h),users:o,onViewBooking:i||(()=>{}),onStatusUpdate:l||(()=>{})}):c==="list"?e.jsx(be,{bookings:t.filter(h),users:o,onViewBooking:i||(()=>{})}):e.jsx(fe,{bookings:t.filter(h),users:o,onViewBooking:i||(()=>{}),onStatusUpdate:l})})]})},ye=(t,o)=>{if(!t||t.length===0)return 0;const i=[...t].reverse().find(l=>l.status===o);return i?W(new Date,F(i.timestamp)):0},Ne=(t,o)=>{let i;switch(t.status){case a.SHOOTING:i=t.assignedShooter;break;case a.EDITING:i=t.assignedPhotoEditor||t.assignedVideoEditor;break;case a.READY_TO_PRINT:i=t.assignedPrinter;break;default:i=t.assignedReceptionist}return o.find(l=>l.id===i)},we=({bookings:t,users:o,onViewBooking:i,onStatusUpdate:l,onUpdateBooking:m})=>{const[d,r]=N.useState(null),[s,p]=N.useState(!1),c=N.useMemo(()=>[{id:"upcoming",title:"Ø§Ù„Ù‚Ø§Ø¯Ù…",icon:e.jsx(E,{size:20}),color:"text-blue-400",bg:"bg-blue-500/10",status:[a.CONFIRMED]},{id:"in-progress",title:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",icon:e.jsx(L,{size:20}),color:"text-purple-400",bg:"bg-purple-500/10",status:[a.SHOOTING,a.SELECTION,a.EDITING,a.PRINTING,a.READY_TO_PRINT,a.READY_FOR_PICKUP]},{id:"delivered",title:"ØªÙ…",icon:e.jsx(P,{size:20}),color:"text-green-400",bg:"bg-green-500/10",status:[a.SHOOTING_COMPLETED,a.DELIVERED,a.ARCHIVED]}],[]),f=(x,h)=>{if(!l)return;const n=t.find(k=>k.id===x);if(!n)return;const g=n.status;console.log("[ReceptionWorkflow] handleDrop called"),console.log("[ReceptionWorkflow] bookingId:",x),console.log("[ReceptionWorkflow] targetColumnId:",h),console.log("[ReceptionWorkflow] currentStatus:",g),console.log("[ReceptionWorkflow] BookingStatus.SHOOTING:",a.SHOOTING),console.log("[ReceptionWorkflow] Are they equal?:",g===a.SHOOTING);let j;switch(h){case"upcoming":j=a.CONFIRMED;break;case"in-progress":console.log("[ReceptionWorkflow] in-progress branch - checking currentStatus..."),g===a.CONFIRMED?(j=a.SHOOTING,console.log("[ReceptionWorkflow] â†’ Setting to SHOOTING (was CONFIRMED)")):g===a.SHOOTING?(j=a.SHOOTING_COMPLETED,console.log("[ReceptionWorkflow] â†’ Setting to SHOOTING_COMPLETED (was SHOOTING)")):(console.log("[ReceptionWorkflow] â†’ Default case, currentStatus:",g),j=g);break;case"delivered":j=a.SHOOTING_COMPLETED;break;default:return}console.log("[ReceptionWorkflow] Final newStatus:",j),console.log("[ReceptionWorkflow] Calling onStatusUpdate..."),l(x,j)},u=(x,h)=>{var T;if(!d||!m)return;const n=((T=d.details)==null?void 0:T.extraItems)||[],g={id:Date.now().toString(),amount:x,description:h},j=[...n,g],k="IQD",_=d.currency||"IQD",O=k===_,w={details:{...d.details,extraItems:j}};O?(w.totalAmount=d.totalAmount+x,w.paidAmount=d.paidAmount+x):(d.originalPackagePrice||(w.originalPackagePrice=d.totalAmount),w.addOnTotal=(d.addOnTotal||0)+x),m(d.id,w),te.success(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${x.toLocaleString()} Ø¯.Ø¹ Ù„Ù„Ø­Ø¬Ø²`),p(!1),r(null)};return e.jsxs("div",{className:"flex-1 flex gap-6 p-6 h-full overflow-hidden bg-[#121212]/50",dir:"rtl",children:[c.map(x=>e.jsx(ve,{column:x,bookings:t.filter(h=>x.status.includes(h.status)),users:o,onViewBooking:i,onDrop:f,onStatusUpdate:l,onQuickAction:h=>{r(h),p(!0)}},x.id)),e.jsx(ee,{isOpen:s,onClose:()=>{p(!1),r(null)},onAdd:(x,h,n)=>u(x,h),bookingCurrency:(d==null?void 0:d.currency)||"IQD"})]})},ve=({column:t,bookings:o,users:i,onViewBooking:l,onDrop:m,onQuickAction:d,onStatusUpdate:r})=>{const[s,p]=N.useState(!1);return e.jsxs("div",{className:b("flex-1 flex flex-col bg-[#1a1a1a] rounded-[2rem] border border-white/5 shadow-2xl transition-all",s&&"ring-2 ring-white/10 bg-[#222]"),onDragOver:c=>{c.preventDefault(),p(!0)},onDragLeave:()=>p(!1),onDrop:c=>{c.preventDefault(),p(!1);const f=c.dataTransfer.getData("bookingId");m(f,t.id)},children:[e.jsx("div",{className:"p-6 pb-2 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:b("w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg",t.bg,t.color),children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:t.title}),e.jsxs("span",{className:"text-xs text-gray-500 font-medium",children:[o.length," Ù…Ù‡Ø§Ù…"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:e.jsxs(z,{initial:!1,children:[o.map(c=>e.jsx(De,{booking:c,users:i,onViewBooking:l,onQuickAction:d,onStatusUpdate:r},c.id)),o.length===0&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-20 grayscale",children:[e.jsx("div",{className:"w-16 h-16 rounded-full border-2 border-dashed border-gray-500 mb-4"}),e.jsx("p",{className:"text-gray-400 text-sm font-bold",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…"})]})]})})]})},De=({booking:t,users:o,onViewBooking:i,onQuickAction:l,onStatusUpdate:m})=>{const[d,r]=N.useState(!1),s=ye(t.statusHistory||[],t.status),p=Ne(t,o),c=t.totalAmount-(t.paidAmount||0);return e.jsxs(D.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},children:[e.jsxs("div",{draggable:!0,onDragStart:f=>{f.dataTransfer.setData("bookingId",t.id),f.dataTransfer.effectAllowed="move"},onClick:()=>r(!0),className:"bg-[#252525] hover:bg-[#2a2a2a] p-4 rounded-2xl border border-white/5 hover:border-white/10 transition-all cursor-pointer group relative overflow-hidden",children:[e.jsx("div",{className:b("absolute top-0 right-0 w-1.5 h-full",t.category===y.WEDDING?"bg-red-500/50":"bg-blue-500/50")}),e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-sm mb-1 group-hover:text-white transition-colors",children:t.clientName}),e.jsxs("p",{className:"text-[10px] text-gray-500 font-medium flex items-center gap-1",children:[e.jsx(A,{size:10}),t.title," â€¢ ",new Date(t.shootDate).toLocaleDateString("ar-IQ")]})]}),e.jsx("div",{className:"bg-white/5 p-2 rounded-xl text-gray-400",children:t.category===y.WEDDING?e.jsx(L,{size:16}):e.jsx(E,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"flex-1 bg-emerald-500/10 px-2 py-1 rounded-lg",children:e.jsxs("span",{className:"text-[9px] text-emerald-400 font-bold",children:["Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",v(t.totalAmount,t.currency)]})}),c>0&&e.jsx("div",{className:"bg-rose-500/10 px-2 py-1 rounded-lg",children:e.jsxs("span",{className:"text-[9px] text-rose-400 font-bold",children:["Ù…ØªØ¨Ù‚ÙŠ: ",v(c,t.currency)]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-white/5",children:[e.jsx("div",{className:"flex items-center gap-2",children:t.status===a.DELIVERED?e.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-green-500",children:[e.jsx(P,{size:12}),e.jsx("span",{children:"ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-gray-400",children:[e.jsx(A,{size:12,className:"text-gray-500"}),e.jsxs("span",{children:["Ù…Ù†Ø° ",s," ÙŠÙˆÙ…"]})]}),s>5&&t.status!==a.CONFIRMED&&e.jsxs("div",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(R,{size:12}),e.jsx("span",{className:"text-[9px] font-black uppercase",children:"Ù…ØªØ£Ø®Ø±"})]})]})}),p&&e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-white/5 rounded-lg border border-white/5",children:[e.jsx("div",{className:b("w-5 h-5 rounded-full flex items-center justify-center text-[9px] font-bold text-white bg-gradient-to-br from-purple-500 to-pink-500"),children:p.name.charAt(0)}),e.jsx("span",{className:"text-[10px] font-bold text-gray-400 truncate max-w-[60px]",children:p.name.split(" ")[0]})]})]})]}),e.jsx(z,{children:d&&e.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[99999] flex items-center justify-center p-4",onClick:()=>r(!1),children:e.jsxs(D.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:f=>f.stopPropagation(),className:"bg-[#1a1c22] rounded-3xl p-6 w-full max-w-sm border border-white/10 shadow-2xl",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-lg font-black",children:t.clientName.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold",children:t.clientName}),e.jsx("p",{className:"text-xs text-gray-500",children:t.title})]})]}),e.jsx("button",{onClick:()=>r(!1),className:"p-2 hover:bg-white/10 rounded-xl transition-colors text-gray-400",children:e.jsx(pe,{size:20})})]}),e.jsxs("div",{className:"bg-black/40 rounded-2xl p-4 mb-6 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"}),e.jsx("span",{className:"text-white font-bold",children:v(t.totalAmount,t.currency)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Ø§Ù„Ù…Ø¯ÙÙˆØ¹"}),e.jsx("span",{className:"text-emerald-400 font-bold",children:v(t.paidAmount||0,t.currency)})]}),e.jsx("div",{className:"h-px bg-white/10 my-2"}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ"}),e.jsx("span",{className:b("font-bold",c>0?"text-rose-400":"text-gray-500"),children:v(c,t.currency)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>{r(!1),l(t)},className:"w-full py-3.5 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-2xl font-bold shadow-lg shadow-purple-500/30 transition-all flex items-center justify-center gap-2",children:[e.jsx(X,{size:18}),"Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¥Ø¶Ø§ÙÙŠØ©"]}),e.jsxs("button",{onClick:()=>{r(!1),i==null||i(t.id,"financials")},className:"w-full py-3 bg-white/5 hover:bg-white/10 border border-white/10 text-white rounded-2xl font-bold transition-all flex items-center justify-center gap-2",children:[e.jsx(me,{size:16}),"Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø§Ù„ÙŠØ©"]}),e.jsx("button",{onClick:()=>{r(!1),i==null||i(t.id,"client")},className:"w-full py-3 bg-white/5 hover:bg-white/10 border border-white/10 text-gray-400 rounded-2xl font-medium transition-all text-sm",children:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„"})]})]})})})]})},Re=({bookings:t,users:o,isDraggable:i,onViewBooking:l,onStatusUpdate:m,onUpdateBooking:d,isReception:r=!0,isManager:s=!1})=>e.jsx(se,{isDraggable:i,isReception:r,isManager:s,hideBackground:!0,noPadding:!0,children:e.jsx("div",{className:"flex flex-col h-full animate-in fade-in",dir:"rtl",children:s?e.jsx(je,{bookings:t,users:o,onViewBooking:l,onStatusUpdate:m,isManager:s}):e.jsx(we,{bookings:t,users:o,onViewBooking:l,onStatusUpdate:m,onUpdateBooking:d})})});export{Re as default};
