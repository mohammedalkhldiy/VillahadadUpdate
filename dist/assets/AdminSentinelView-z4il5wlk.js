const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BFvmHygk.js","./vendor-react-Ce27NbrU.js","./vendor-ui-TjLGESBy.js","./vendor-supabase-CSCOup90.js","./vendor-utils-DKqDJWuS.js","./index-BLpVv1z6.css"])))=>i.map(i=>d[i]);
import{u as _,c as B,U as c,_ as L}from"./index-BFvmHygk.js";import{r as o,j as e}from"./vendor-react-Ce27NbrU.js";import{ah as V,af as f,d as w,y as z,Z as G,l as U,m as H}from"./vendor-ui-TjLGESBy.js";import{R as K,q as X}from"./generateCategoricalChart-NQEqos2u.js";import{A as Z,X as $,a as q}from"./AreaChart-Dq4vkcq7.js";import"./vendor-supabase-CSCOup90.js";import"./vendor-utils-DKqDJWuS.js";import"./clsx-B-dksMZM.js";const k=n=>{switch(n){case c.MANAGER:return"المديرة";case c.ADMIN:return"المشرف";case c.RECEPTION:return"الاستقبال";case c.PHOTO_EDITOR:return"مصمم صور";case c.VIDEO_EDITOR:return"مونتير";case c.PRINTER:return"الطباعة";case c.SELECTOR:return"الانتقاء";default:return n}},A=n=>{switch(n){case c.MANAGER:return"text-amber-400";case c.ADMIN:return"text-purple-400";case c.RECEPTION:return"text-rose-400";case c.PHOTO_EDITOR:return"text-blue-400";case c.VIDEO_EDITOR:return"text-emerald-400";case c.PRINTER:return"text-indigo-400";default:return"text-zinc-400"}},ae=()=>{const{users:n}=_(),{bookings:E}=B(),[j,R]=o.useState([]),[d,I]=o.useState([]),[N,O]=o.useState([]),[D,P]=o.useState(!0);o.useEffect(()=>{(async()=>{const{electronBackend:s}=await L(async()=>{const{electronBackend:h}=await import("./index-BFvmHygk.js").then(p=>p.L);return{electronBackend:h}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url),[r,l,x]=await Promise.all([s.getProductivityStats(),s.getTodayAttendance(),s.getEmployeeActionsToday()]);R(r),I(l),O(x),P(!1)})()},[]);const i=(n||[]).filter(t=>t.role!==c.ADMIN),m=t=>{const s=N.find(a=>String(a.userId)===t),r=s?Number(s.actionCount):0,l=d.find(a=>String(a.userId)===t),x=(l==null?void 0:l.checkIn)||null,h=(l==null?void 0:l.checkOut)||null,p=(l==null?void 0:l.status)||"غير مسجل";let u=0;if(x){const[a,M]=x.split(":").map(Number),y=a*60+M,v=540;y>v&&(u=y-v)}const g=E.filter(a=>a.assignedShooter===t||a.assignedPhotoEditor===t||a.assignedPrinter===t||a.assignedReceptionist===t||a.createdBy===t),C=g.filter(a=>a.status==="delivered"||a.status==="completed");return{actionsToday:r,checkIn:x,checkOut:h,status:p,lateMinutes:u,totalBookings:g.length,completedBookings:C.length}},b=d.filter(t=>t.status==="Present"||t.checkIn).length,T=d.filter(t=>{if(!t.checkIn)return!1;const[s,r]=t.checkIn.split(":").map(Number);return s*60+r>540}).length;i.length-b;const S=N.reduce((t,s)=>t+Number(s.actionCount||0),0);return D?e.jsx("div",{className:"h-full flex items-center justify-center text-zinc-500",children:"جارِ التحميل..."}):e.jsxs("div",{className:"h-full flex flex-col font-sans p-4 gap-4",dir:"rtl",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/10 border border-red-500/20",children:e.jsx(V,{className:"text-red-500",size:22})}),"مراقبة أداء الموظفين"]}),e.jsx("p",{className:"text-zinc-500 text-xs tracking-wider mt-1",children:"بيانات حية من النظام"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"px-3 py-1.5 bg-zinc-900 border border-white/[0.06] text-xs text-zinc-400 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 animate-pulse"}),new Date().toLocaleDateString("ar-IQ",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-[#111] border border-white/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(f,{size:16,className:"text-zinc-500"}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:"الفريق"})]}),e.jsx("div",{className:"text-2xl font-black text-white",children:i.length}),e.jsx("div",{className:"text-[10px] text-zinc-500 mt-1",children:"عدد الموظفين"})]}),e.jsxs("div",{className:"bg-[#111] border border-white/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:16,className:"text-emerald-500"}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:"حاضر"})]}),e.jsx("div",{className:"text-2xl font-black text-emerald-400",children:b}),e.jsx("div",{className:"text-[10px] text-zinc-500 mt-1",children:"سجلوا حضور"})]}),e.jsxs("div",{className:"bg-[#111] border border-white/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(z,{size:16,className:"text-amber-500"}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:"متأخر"})]}),e.jsx("div",{className:"text-2xl font-black text-amber-400",children:T}),e.jsx("div",{className:"text-[10px] text-zinc-500 mt-1",children:"تأخروا اليوم"})]}),e.jsxs("div",{className:"bg-[#111] border border-white/[0.06] p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(G,{size:16,className:"text-blue-500"}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:"إجراءات"})]}),e.jsx("div",{className:"text-2xl font-black text-blue-400",children:S}),e.jsx("div",{className:"text-[10px] text-zinc-500 mt-1",children:"عملية اليوم"})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 flex-1 min-h-0",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-8 bg-[#111] border border-white/[0.06] p-5 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white flex items-center gap-2",children:[e.jsx(U,{className:"text-yellow-500",size:16}),"نبض الإنتاجية - اليوم"]}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:"عدد الإجراءات بالساعة"})]}),e.jsx("div",{className:"flex-1 w-full min-h-0",children:j.length>0?e.jsx(K,{width:"100%",height:"100%",children:e.jsxs(Z,{data:j,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPulse",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#eab308",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#eab308",stopOpacity:0})]})}),e.jsx($,{dataKey:"time",stroke:"#3f3f46",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(X,{contentStyle:{backgroundColor:"#111",border:"1px solid #222",borderRadius:0},itemStyle:{color:"#fbbf24"}}),e.jsx(q,{type:"monotone",dataKey:"actions",stroke:"#eab308",strokeWidth:2,fillOpacity:1,fill:"url(#colorPulse)"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-zinc-600 text-sm",children:"لا توجد بيانات إنتاجية اليوم"})})]}),e.jsxs("div",{className:"col-span-12 lg:col-span-4 bg-[#111] border border-white/[0.06] p-5 flex flex-col",children:[e.jsxs("h3",{className:"text-sm font-bold text-white flex items-center gap-2 mb-4",children:[e.jsx(z,{className:"text-red-400",size:16}),"التأخيرات اليوم"]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-2",children:[i.map(t=>{const s=m(t.id);return s.lateMinutes<=0?null:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-500/5 border border-red-500/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-zinc-800 flex items-center justify-center text-white text-xs font-bold border border-white/10",children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-xs font-bold",children:t.name}),e.jsx("p",{className:`text-[10px] ${A(t.role)}`,children:k(t.role)})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"text-red-400 text-xs font-bold font-mono",children:[s.lateMinutes," د"]}),e.jsxs("p",{className:"text-[10px] text-zinc-500",children:["دخول: ",s.checkIn]})]})]},t.id)}).filter(Boolean),i.every(t=>m(t.id).lateMinutes<=0)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(w,{size:24,className:"text-emerald-500/30 mb-2"}),e.jsx("p",{className:"text-zinc-500 text-xs",children:"لا توجد تأخيرات اليوم"})]})]})]}),e.jsxs("div",{className:"col-span-12 bg-[#111] border border-white/[0.06] p-5 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-white flex items-center gap-2",children:[e.jsx(f,{className:"text-zinc-400",size:16}),"جدول الموظفين - نظرة شاملة"]}),e.jsxs("span",{className:"text-[10px] text-zinc-500",children:[i.length," موظف"]})]}),e.jsxs("div",{className:"overflow-x-auto flex-1",children:[e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{className:"text-[10px] text-zinc-500 font-bold uppercase tracking-wider border-b border-white/[0.06]",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-3",children:"الموظف"}),e.jsx("th",{className:"py-3 px-3",children:"الوظيفة"}),e.jsx("th",{className:"py-3 px-3",children:"الحضور"}),e.jsx("th",{className:"py-3 px-3",children:"وقت الدخول"}),e.jsx("th",{className:"py-3 px-3",children:"التأخير"}),e.jsx("th",{className:"py-3 px-3",children:"إجراءات اليوم"}),e.jsx("th",{className:"py-3 px-3",children:"حجوزات مسندة"}),e.jsx("th",{className:"py-3 px-3",children:"مكتملة"})]})}),e.jsx("tbody",{className:"text-sm text-zinc-300 divide-y divide-white/[0.03]",children:i.map(t=>{const s=m(t.id);return e.jsxs(H.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-white/[0.02] transition-colors",children:[e.jsx("td",{className:"py-3 px-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-zinc-800 flex items-center justify-center text-white text-[10px] font-bold border border-white/10",children:t.name.charAt(0)}),e.jsx("span",{className:"font-bold text-white text-xs",children:t.name})]})}),e.jsx("td",{className:"py-3 px-3",children:e.jsx("span",{className:`text-xs ${A(t.role)}`,children:k(t.role)})}),e.jsx("td",{className:"py-3 px-3",children:s.checkIn?e.jsx("span",{className:"text-[10px] font-bold text-emerald-400 bg-emerald-500/10 px-2 py-1",children:"حاضر"}):e.jsx("span",{className:"text-[10px] font-bold text-zinc-500 bg-zinc-800 px-2 py-1",children:"غير مسجل"})}),e.jsx("td",{className:"py-3 px-3 text-xs font-mono text-zinc-400",children:s.checkIn||"—"}),e.jsx("td",{className:"py-3 px-3",children:s.lateMinutes>0?e.jsxs("span",{className:"text-[10px] font-bold text-red-400 bg-red-500/10 px-2 py-1",children:[s.lateMinutes," د"]}):s.checkIn?e.jsx("span",{className:"text-[10px] text-emerald-400",children:"في الوقت"}):e.jsx("span",{className:"text-[10px] text-zinc-600",children:"—"})}),e.jsx("td",{className:"py-3 px-3 text-xs font-mono font-bold text-white",children:s.actionsToday}),e.jsx("td",{className:"py-3 px-3 text-xs font-mono text-zinc-400",children:s.totalBookings}),e.jsx("td",{className:"py-3 px-3 text-xs font-mono text-emerald-400",children:s.completedBookings})]},t.id)})})]}),i.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(f,{size:32,className:"text-zinc-700 mb-3"}),e.jsx("p",{className:"text-zinc-500 text-sm",children:"لا يوجد موظفين مسجلين"})]})]})]})]})]})};export{ae as default};
